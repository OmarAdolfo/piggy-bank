(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{Sidq:function(e,r,o){"use strict";o.r(r);var t=o("PCNd"),i=o("tyNb"),s=o("3Pt+"),n=o("Y5fV"),c=o("fXoL"),a=o("AytR"),l=o("tk/3");let b=(()=>{class e{constructor(e){this.http=e,this.url=a.a.url+"usuarios"}get(e,r,o,t){let i=[],s="";return e.nombre&&i.push("nombre="+e.nombre),e.apellidos&&i.push("apellidos="+e.apellidos),e.email&&i.push("email="+e.email),e.rol&&i.push("rol="+e.rol),r&&(i.push("sortable="+r),o&&i.push(1===o?"orderBy=asc":"orderBy=desc")),t&&i.push("page="+t),i.length>0&&(s="?"+i.join("&")),this.http.get(this.url+s)}add(e){return this.http.post(this.url,e)}update(e){return this.http.put(this.url+"/"+e.id,e)}delete(e){return this.http.delete(this.url+"/"+e)}find(e){return this.http.get(this.url+"/"+e)}}return e.\u0275fac=function(r){return new(r||e)(c.Xb(l.b))},e.\u0275prov=c.Jb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var d=o("7zfz"),u=o("5o1E"),m=o("ofXK"),f=o("rEr+"),p=o("jIHw");function h(e,r){if(1&e&&c.Ob(0,"p-sortIcon",24),2&e){const e=c.dc().$implicit;c.jc("field",e.field)}}function v(e,r){if(1&e&&(c.Tb(0,"th",22),c.Gc(1),c.Ec(2,h,1,1,"p-sortIcon",23),c.Sb()),2&e){const e=r.$implicit;c.jc("pSortableColumn",e.field),c.Bb(1),c.Ic(" ",e.header," "),c.Bb(1),c.jc("ngIf",e.sortOrder)}}function S(e,r){if(1&e&&(c.Tb(0,"tr"),c.Ec(1,v,3,3,"th",21),c.Sb()),2&e){const e=r.$implicit;c.Bb(1),c.jc("ngForOf",e)}}function g(e,r){if(1&e){const e=c.Ub();c.Tb(0,"tr",25),c.Tb(1,"td"),c.Tb(2,"span",26),c.Gc(3,"Nombre"),c.Sb(),c.Gc(4),c.Sb(),c.Tb(5,"td"),c.Tb(6,"span",26),c.Gc(7,"Apellidos"),c.Sb(),c.Gc(8),c.Sb(),c.Tb(9,"td"),c.Tb(10,"span",26),c.Gc(11,"Correo electr\xf3nico"),c.Sb(),c.Gc(12),c.Sb(),c.Tb(13,"td"),c.Tb(14,"span",26),c.Gc(15,"Rol"),c.Sb(),c.Gc(16),c.Sb(),c.Tb(17,"td"),c.Tb(18,"button",27),c.bc("click",(function(){c.wc(e);const o=r.$implicit;return c.dc().onRowSelect(o.id)})),c.Tb(19,"span"),c.Ob(20,"i",28),c.Sb(),c.Sb(),c.Tb(21,"button",27),c.bc("click",(function(){c.wc(e);const o=r.$implicit;return c.dc().confirm(o.id)})),c.Tb(22,"span"),c.Ob(23,"i",29),c.Sb(),c.Sb(),c.Sb(),c.Sb()}if(2&e){const e=r.$implicit;c.jc("pSelectableRow",e),c.Bb(4),c.Ic(" ",e.nombre," "),c.Bb(4),c.Ic(" ",e.apellidos," "),c.Bb(4),c.Ic(" ",e.email," "),c.Bb(4),c.Ic(" ",e.rol," ")}}function T(e,r){if(1&e){const e=c.Ub();c.Tb(0,"div",30),c.Tb(1,"button",31),c.bc("click",(function(){return c.wc(e),c.dc().add()})),c.Sb(),c.Sb()}}const y=function(e,r){return{"fa-search":e,"fa-spinner fa-spin":r}};let w=(()=>{class e{constructor(e,r,o,t,i){this.userService=e,this.formBuilder=r,this.messageService=o,this.confirmationService=t,this.router=i,this.cols=[{field:"nombre",header:"Nombre",sortOrder:!0},{field:"apellidos",header:"Apellidos",sortOrder:!0},{field:"email",header:"Correo electr\xf3nico",sortOrder:!0},{field:"rol",header:"Rol",sortOrder:!0},{field:"",header:"Opciones",sortOrder:!1}],this.roles=[{label:n.a.Admin,value:n.a.Admin.toString()},{label:n.a.User,value:n.a.User.toString()}]}ngOnInit(){this.buildForm()}buildForm(){this.form=this.formBuilder.group({nombre:new s.c(""),apellidos:new s.c(""),email:new s.c(""),rol:new s.c("")})}add(){this.router.navigate(["/home/users/new"])}search(e,r,o){Promise.resolve().then(()=>this.loading=!0),this.userService.get(this.form.value,e,r,o).subscribe(e=>{this.users=e.data.data,this.totalRecords=e.data.total,this.loading=!1},()=>{this.loading=!1})}customSort(e){this.search(e.sortField,e.sortOrder,e.first/e.rows+1)}confirm(e){this.confirmationService.confirm({message:"\xbfEst\xe1s seguro de que deseas borrar?",header:"Confirmaci\xf3n",icon:"pi pi-exclamation-triangle",accept:()=>{this.delete(e)}})}delete(e){this.userService.delete(e).subscribe(r=>{this.users=this.users.filter(r=>r.id!==e),this.messageService.add({severity:"success",summary:"\xc9xito",detail:r.message})},e=>{this.messageService.add({severity:"error",summary:"Error",detail:e.error.message})})}onRowSelect(e){this.router.navigate(["/home/users/"+e])}}return e.\u0275fac=function(r){return new(r||e)(c.Nb(b),c.Nb(s.b),c.Nb(d.d),c.Nb(d.a),c.Nb(i.b))},e.\u0275cmp=c.Hb({type:e,selectors:[["app-user"]],decls:48,vars:14,consts:[[1,"wrapper"],[1,"row"],[1,"col-12"],[1,"card","mt-3"],[1,"card-header","bg-primary","text-white"],[1,"card-body"],[3,"formGroup"],[1,"col-12","col-md-6","form-group"],["for","nombre"],["type","text","id","nombre","formControlName","nombre",1,"form-control","form-control-user"],["type","text","id","apellidos","formControlName","apellidos",1,"form-control","form-control-user"],[1,"row","mt-1"],["type","text","id","email","formControlName","email",1,"form-control","form-control-user"],["id","rol","formControlName","rol",3,"options"],[1,"col-12","text-right","mt-2"],["type","button",1,"btn","btn-primary","mr-1",3,"disabled","click"],["aria-hidden","true",1,"fas",3,"ngClass"],["selectionMode","single",3,"columns","value","paginator","rows","responsive","lazy","totalRecords","onLazyLoad"],["pTemplate","header"],["pTemplate","body"],["pTemplate","summary"],[3,"pSortableColumn",4,"ngFor","ngForOf"],[3,"pSortableColumn"],[3,"field",4,"ngIf"],[3,"field"],[3,"pSelectableRow"],[1,"ui-column-title"],["type","button",1,"btn","btn-secondary","mr-1",3,"click"],["aria-hidden","true",1,"fas","fa-edit"],["aria-hidden","true",1,"fas","fa-trash"],[2,"text-align","left"],["type","button","pButton","","icon","pi pi-plus","label","A\xf1adir",3,"click"]],template:function(e,r){1&e&&(c.Tb(0,"div",0),c.Tb(1,"div",1),c.Tb(2,"div",2),c.Tb(3,"h1"),c.Gc(4,"Usuarios"),c.Sb(),c.Sb(),c.Sb(),c.Ob(5,"hr"),c.Tb(6,"div",3),c.Tb(7,"div",4),c.Gc(8," Buscador de usuarios "),c.Sb(),c.Tb(9,"div",5),c.Tb(10,"div",1),c.Tb(11,"div",2),c.Tb(12,"form",6),c.Tb(13,"div",1),c.Tb(14,"div",7),c.Tb(15,"label",8),c.Gc(16,"Nombre"),c.Sb(),c.Ob(17,"input",9),c.Sb(),c.Tb(18,"div",7),c.Tb(19,"label",8),c.Gc(20,"Apellidos"),c.Sb(),c.Ob(21,"input",10),c.Sb(),c.Sb(),c.Tb(22,"div",11),c.Tb(23,"div",7),c.Tb(24,"label",8),c.Gc(25,"Correo electr\xf3nico"),c.Sb(),c.Ob(26,"input",12),c.Sb(),c.Tb(27,"div",7),c.Tb(28,"label",8),c.Gc(29,"Rol"),c.Sb(),c.Tb(30,"div"),c.Ob(31,"p-selectButton",13),c.Sb(),c.Sb(),c.Sb(),c.Tb(32,"div",11),c.Tb(33,"div",14),c.Tb(34,"button",15),c.bc("click",(function(){return r.search()})),c.Ob(35,"i",16),c.Tb(36,"span"),c.Gc(37," Buscar"),c.Sb(),c.Sb(),c.Sb(),c.Sb(),c.Sb(),c.Sb(),c.Sb(),c.Sb(),c.Sb(),c.Tb(38,"div",3),c.Tb(39,"div",4),c.Gc(40," Listado de usuarios "),c.Sb(),c.Tb(41,"div",5),c.Tb(42,"div",1),c.Tb(43,"div",2),c.Tb(44,"p-table",17),c.bc("onLazyLoad",(function(e){return r.customSort(e)})),c.Ec(45,S,2,1,"ng-template",18),c.Ec(46,g,24,5,"ng-template",19),c.Ec(47,T,2,0,"ng-template",20),c.Sb(),c.Sb(),c.Sb(),c.Sb(),c.Sb(),c.Sb()),2&e&&(c.Bb(12),c.jc("formGroup",r.form),c.Bb(19),c.jc("options",r.roles),c.Bb(3),c.jc("disabled",r.loading),c.Bb(1),c.jc("ngClass",c.nc(11,y,!r.loading,r.loading)),c.Bb(9),c.jc("columns",r.cols)("value",r.users)("paginator",!0)("rows",10)("responsive",!0)("lazy",!0)("totalRecords",r.totalRecords))},directives:[s.o,s.i,s.e,s.a,s.h,s.d,u.a,m.i,f.d,d.e,m.j,f.c,m.k,f.b,f.a,p.a],styles:[""]}),e})();class B{}var G=o("wMtC"),j=o("Gxio");function E(e,r){1&e&&(c.Tb(0,"div",1),c.Ob(1,"img",9),c.Sb())}function I(e,r){1&e&&(c.Tb(0,"div"),c.Gc(1," El nombre es obligatorio "),c.Sb())}function O(e,r){1&e&&(c.Tb(0,"div"),c.Gc(1," El nombre no puede ser vac\xedo "),c.Sb())}function C(e,r){if(1&e&&(c.Tb(0,"div",28),c.Ec(1,I,2,0,"div",27),c.Ec(2,O,2,0,"div",27),c.Sb()),2&e){const e=c.dc(2);c.Bb(1),c.jc("ngIf",e.form.controls.nombre.errors.required),c.Bb(1),c.jc("ngIf",e.form.controls.nombre.errors.whitespace)}}function N(e,r){1&e&&(c.Tb(0,"div"),c.Gc(1," Los apellidos son obligatorios "),c.Sb())}function k(e,r){1&e&&(c.Tb(0,"div"),c.Gc(1," Los apellidos no pueden ser vac\xedos "),c.Sb())}function x(e,r){if(1&e&&(c.Tb(0,"div",28),c.Ec(1,N,2,0,"div",27),c.Ec(2,k,2,0,"div",27),c.Sb()),2&e){const e=c.dc(2);c.Bb(1),c.jc("ngIf",e.form.controls.apellidos.errors.required),c.Bb(1),c.jc("ngIf",e.form.controls.nombre.errors.whitespace)}}function R(e,r){1&e&&(c.Tb(0,"div"),c.Gc(1," El rol es obligatorio "),c.Sb())}function U(e,r){if(1&e&&(c.Tb(0,"div",28),c.Ec(1,R,2,0,"div",27),c.Sb()),2&e){const e=c.dc(2);c.Bb(1),c.jc("ngIf",e.form.controls.rol.errors.required)}}function q(e,r){1&e&&(c.Tb(0,"div"),c.Gc(1," El correo electr\xf3nico es obligatorio "),c.Sb())}function A(e,r){1&e&&(c.Tb(0,"div"),c.Gc(1," El correo electr\xf3nico no tiene un formato correcto "),c.Sb())}function L(e,r){if(1&e&&(c.Tb(0,"div",28),c.Ec(1,q,2,0,"div",27),c.Ec(2,A,2,0,"div",27),c.Sb()),2&e){const e=c.dc(2);c.Bb(1),c.jc("ngIf",e.form.controls.email.errors.required),c.Bb(1),c.jc("ngIf",e.form.controls.email.errors.email)}}const F=function(e,r){return{"fa-save":e,"fa-spinner fa-spin":r}};function z(e,r){if(1&e&&(c.Tb(0,"span"),c.Ob(1,"i",29),c.Gc(2," Guardar"),c.Sb()),2&e){const e=c.dc(2);c.Bb(1),c.jc("ngClass",c.nc(1,F,!e.loading,e.loading))}}const $=function(e,r){return{"fa-edit":e,"fa-spinner fa-spin":r}};function P(e,r){if(1&e&&(c.Tb(0,"span"),c.Ob(1,"i",29),c.Gc(2," Editar"),c.Sb()),2&e){const e=c.dc(2);c.Bb(1),c.jc("ngClass",c.nc(1,$,!e.loading,e.loading))}}function H(e,r){if(1&e){const e=c.Ub();c.Tb(0,"div",10),c.Tb(1,"div",11),c.Gc(2," Dise\xf1ador usuario "),c.Sb(),c.Tb(3,"div",12),c.Tb(4,"div",1),c.Tb(5,"div",2),c.Tb(6,"form",13),c.Tb(7,"div",1),c.Tb(8,"div",14),c.Tb(9,"label",15),c.Gc(10,"Nombre"),c.Sb(),c.Ob(11,"input",16),c.Ec(12,C,3,2,"div",17),c.Sb(),c.Tb(13,"div",14),c.Tb(14,"label",18),c.Gc(15,"Apellidos"),c.Sb(),c.Ob(16,"input",19),c.Ec(17,x,3,2,"div",17),c.Sb(),c.Tb(18,"div",14),c.Tb(19,"label",20),c.Gc(20,"Rol"),c.Sb(),c.Tb(21,"div"),c.Ob(22,"p-selectButton",21),c.Ec(23,U,2,1,"div",17),c.Sb(),c.Sb(),c.Tb(24,"div",14),c.Tb(25,"label",22),c.Gc(26,"Correo electr\xf3nico"),c.Sb(),c.Ob(27,"input",23),c.Ec(28,L,3,2,"div",17),c.Sb(),c.Sb(),c.Tb(29,"div",24),c.Tb(30,"div",25),c.Tb(31,"button",26),c.bc("click",(function(){return c.wc(e),c.dc().save()})),c.Ec(32,z,3,4,"span",27),c.Ec(33,P,3,4,"span",27),c.Sb(),c.Sb(),c.Sb(),c.Sb(),c.Sb(),c.Sb(),c.Sb(),c.Sb()}if(2&e){const e=c.dc();c.Bb(6),c.jc("formGroup",e.form),c.Bb(6),c.jc("ngIf",e.form.controls.nombre.invalid&&(e.form.controls.nombre.dirty||e.form.controls.nombre.touched)),c.Bb(5),c.jc("ngIf",e.form.controls.apellidos.invalid&&(e.form.controls.apellidos.dirty||e.form.controls.apellidos.touched)),c.Bb(5),c.jc("options",e.roles),c.Bb(1),c.jc("ngIf",e.form.controls.rol.invalid&&(e.form.controls.rol.dirty||e.form.controls.rol.touched)),c.Bb(5),c.jc("ngIf",e.form.controls.email.invalid&&(e.form.controls.email.dirty||e.form.controls.email.touched)),c.Bb(3),c.jc("disabled",e.form.pristine||e.form.invalid||e.loading),c.Bb(1),c.jc("ngIf",e.newUser),c.Bb(1),c.jc("ngIf",!e.newUser)}}const J=function(){return{marginTop:"80px"}},K=[{path:"",component:w},{path:":id",component:(()=>{class e{constructor(e,r,o,t,i){this.formBuilder=e,this.userService=r,this.messageService=o,this.activatedRoute=t,this.location=i,this.roles=[{label:n.a.Admin,value:n.a.Admin.toString()},{label:n.a.User,value:n.a.User.toString()}]}ngOnInit(){this.newUser="new"===this.activatedRoute.snapshot.params.id,this.newUser?(this.user=new B,this.buildForm()):(Promise.resolve().then(()=>this.loading=!0),this.userService.find(this.activatedRoute.snapshot.params.id).subscribe(e=>{this.user=e.data,this.loading=!1,this.buildForm()},e=>{this.loading=!1,this.messageService.add({severity:"error",summary:"Error",detail:e.error.message})}))}buildForm(){this.form=this.formBuilder.group({nombre:new s.c(this.user.nombre,[s.n.required,G.a]),apellidos:new s.c(this.user.apellidos,[s.n.required,G.a]),email:new s.c(this.user.email,[s.n.required,s.n.email]),rol:new s.c(this.user.rol,s.n.required)})}save(){if(Promise.resolve().then(()=>this.loading=!0),this.user.id)this.user.nombre=this.form.get("nombre").value,this.user.apellidos=this.form.get("apellidos").value,this.user.email=this.form.get("email").value,this.user.rol=this.form.get("rol").value,this.userService.update(this.user).subscribe(e=>{this.messageService.add({severity:"success",summary:"\xc9xito",detail:e.message}),this.loading=!1,this.back()},e=>{this.messageService.add({severity:"error",summary:"Error",detail:e.error.message}),this.loading=!1});else{const e=Object.assign({},this.form.value);this.userService.add(e).subscribe(e=>{this.messageService.add({severity:"success",summary:"\xc9xito",detail:e.message}),this.loading=!1,this.back()},e=>{this.messageService.add({severity:"error",summary:"Error",detail:e.error.message}),this.loading=!1})}}back(){this.location.back()}}return e.\u0275fac=function(r){return new(r||e)(c.Nb(s.b),c.Nb(b),c.Nb(d.d),c.Nb(i.a),c.Nb(m.g))},e.\u0275cmp=c.Hb({type:e,selectors:[["app-user-detail"]],decls:15,vars:5,consts:[[1,"wrapper"],[1,"row"],[1,"col-12"],["class","row",4,"ngIf"],["class","card",4,"ngIf"],[1,"row","mt-3"],[1,"col-12","text-right"],["type","button",1,"btn","btn-secondary","mr-1",3,"click"],["aria-hidden","true",1,"fas","fa-arrow-left"],["src","./assets/notfound.png","alt","No existen resultados",1,"d-block","mx-auto","img-not-found"],[1,"card"],[1,"card-header","bg-primary","text-white"],[1,"card-body"],[3,"formGroup"],[1,"col-12","col-md-6","form-group"],["for","nombre"],["type","text","id","nombre","formControlName","nombre",1,"form-control","form-control-user"],["class","alert alert-danger mt-1",4,"ngIf"],["for","apellidos"],["type","text","id","apellidos","formControlName","apellidos",1,"form-control","form-control-user"],["for","rol"],["formControlName","rol",3,"options"],["for","email"],["type","text","id","email","formControlName","email",1,"form-control","form-control-user"],[1,"row","mt-1"],[1,"col-12","text-right","mt-2"],["type","button",1,"btn","btn-primary","mr-1",3,"disabled","click"],[4,"ngIf"],[1,"alert","alert-danger","mt-1"],["aria-hidden","true",1,"fas",3,"ngClass"]],template:function(e,r){1&e&&(c.Tb(0,"div",0),c.Tb(1,"div",1),c.Tb(2,"div",2),c.Tb(3,"h1"),c.Gc(4,"Detalle usuario"),c.Sb(),c.Sb(),c.Sb(),c.Ob(5,"hr"),c.Ec(6,E,2,0,"div",3),c.Ec(7,H,34,9,"div",4),c.Tb(8,"div",5),c.Tb(9,"div",6),c.Tb(10,"button",7),c.bc("click",(function(){return r.back()})),c.Tb(11,"span"),c.Ob(12,"i",8),c.Gc(13," Volver"),c.Sb(),c.Sb(),c.Sb(),c.Sb(),c.Sb(),c.Ob(14,"p-toast")),2&e&&(c.Bb(6),c.jc("ngIf",!r.user&&!r.loading),c.Bb(1),c.jc("ngIf",r.user),c.Bb(7),c.Cc(c.lc(4,J)))},directives:[m.k,j.a,s.o,s.i,s.e,s.a,s.h,s.d,u.a,m.i],styles:[""]}),e})()}];let M=(()=>{class e{}return e.\u0275mod=c.Lb({type:e}),e.\u0275inj=c.Kb({factory:function(r){return new(r||e)},imports:[[i.e.forChild(K)],i.e]}),e})();o.d(r,"UserModule",(function(){return X}));let X=(()=>{class e{}return e.\u0275mod=c.Lb({type:e}),e.\u0275inj=c.Kb({factory:function(r){return new(r||e)},imports:[[t.a,M]]}),e})()}}]);