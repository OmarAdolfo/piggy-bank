(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{XWaT:function(e,t,o){"use strict";o.r(t);var i=o("PCNd"),s=o("I5S5"),a=o("tyNb"),n=o("3Pt+");class r{}var c=o("fXoL"),d=o("0MV2"),l=o("7zfz"),b=o("qan5"),m=o("LuMj"),u=o("ofXK"),p=o("arFO");function g(e,t){1&e&&(c.Ub(0,"div"),c.Hc(1," El a\xf1o es obligatorio "),c.Tb())}function h(e,t){1&e&&(c.Ub(0,"div"),c.Hc(1," El a\xf1o debe estar formado por cuatro n\xfameros "),c.Tb())}function f(e,t){if(1&e&&(c.Ub(0,"div",24),c.Fc(1,g,2,0,"div",25),c.Fc(2,h,2,0,"div",25),c.Tb()),2&e){const e=c.ec(2);c.Cb(1),c.kc("ngIf",e.addForm.controls.anno.errors.required),c.Cb(1),c.kc("ngIf",e.addForm.controls.anno.errors.pattern)}}function v(e,t){1&e&&(c.Ub(0,"div"),c.Hc(1," El mes es obligatorio "),c.Tb())}function T(e,t){if(1&e&&(c.Ub(0,"div",24),c.Fc(1,v,2,0,"div",25),c.Tb()),2&e){const e=c.ec(2);c.Cb(1),c.kc("ngIf",e.addForm.controls.mes.errors.required)}}const U=function(e,t){return{"fa-plus":e,"fa-spinner fa-spin":t}};function y(e,t){if(1&e){const e=c.Vb();c.Ub(0,"form",14),c.Ub(1,"div",3),c.Ub(2,"div",15),c.Ub(3,"label",16),c.Hc(4,"A\xf1o"),c.Tb(),c.Pb(5,"input",17),c.Fc(6,f,3,2,"div",18),c.Tb(),c.Ub(7,"div",15),c.Ub(8,"label",19),c.Hc(9,"Mes"),c.Tb(),c.Pb(10,"p-dropdown",20),c.Fc(11,T,2,1,"div",18),c.Tb(),c.Tb(),c.Ub(12,"div",1),c.Ub(13,"div",21),c.Ub(14,"button",22),c.cc("click",(function(){return c.xc(e),c.ec().addTemplate()})),c.Pb(15,"i",23),c.Ub(16,"span"),c.Hc(17," A\xf1adir"),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb()}if(2&e){const e=c.ec();c.kc("formGroup",e.addForm),c.Cb(6),c.kc("ngIf",e.addForm.controls.anno.invalid&&(e.addForm.controls.anno.dirty||e.addForm.controls.anno.touched)),c.Cb(4),c.kc("options",e.months)("showClear",!0),c.Cb(1),c.kc("ngIf",e.addForm.controls.mes.invalid&&(e.addForm.controls.mes.dirty||e.addForm.controls.mes.touched)),c.Cb(3),c.kc("disabled",e.addForm.pristine||e.addForm.invalid||e.loading),c.Cb(1),c.kc("ngClass",c.oc(7,U,!e.loading,e.loading))}}function C(e,t){1&e&&(c.Ub(0,"div"),c.Hc(1," El a\xf1o es obligatorio "),c.Tb())}function k(e,t){1&e&&(c.Ub(0,"div"),c.Hc(1," El a\xf1o debe estar formado por cuatro n\xfameros "),c.Tb())}function x(e,t){if(1&e&&(c.Ub(0,"div",24),c.Fc(1,C,2,0,"div",25),c.Fc(2,k,2,0,"div",25),c.Tb()),2&e){const e=c.ec(2);c.Cb(1),c.kc("ngIf",e.cloneForm.controls.anno.errors.required),c.Cb(1),c.kc("ngIf",e.cloneForm.controls.anno.errors.pattern)}}function F(e,t){1&e&&(c.Ub(0,"div"),c.Hc(1," El mes es obligatorio "),c.Tb())}function w(e,t){if(1&e&&(c.Ub(0,"div",24),c.Fc(1,F,2,0,"div",25),c.Tb()),2&e){const e=c.ec(2);c.Cb(1),c.kc("ngIf",e.cloneForm.controls.mes.errors.required)}}function P(e,t){1&e&&(c.Ub(0,"div"),c.Hc(1," El a\xf1o es obligatorio "),c.Tb())}function M(e,t){1&e&&(c.Ub(0,"div"),c.Hc(1," El a\xf1o debe estar formado por cuatro n\xfameros "),c.Tb())}function S(e,t){if(1&e&&(c.Ub(0,"div",24),c.Fc(1,P,2,0,"div",25),c.Fc(2,M,2,0,"div",25),c.Tb()),2&e){const e=c.ec(2);c.Cb(1),c.kc("ngIf",e.cloneForm.controls.newAnno.errors.required),c.Cb(1),c.kc("ngIf",e.cloneForm.controls.newAnno.errors.pattern)}}function H(e,t){1&e&&(c.Ub(0,"div"),c.Hc(1," El mes es obligatorio "),c.Tb())}function I(e,t){if(1&e&&(c.Ub(0,"div",24),c.Fc(1,H,2,0,"div",25),c.Tb()),2&e){const e=c.ec(2);c.Cb(1),c.kc("ngIf",e.cloneForm.controls.newMes.errors.required)}}const E=function(e,t){return{"fa-edit":e,"fa-spinner fa-spin":t}};function O(e,t){if(1&e){const e=c.Vb();c.Ub(0,"form",14),c.Ub(1,"div",3),c.Ub(2,"div",15),c.Ub(3,"label",16),c.Hc(4,"A\xf1o"),c.Tb(),c.Pb(5,"input",17),c.Fc(6,x,3,2,"div",18),c.Tb(),c.Ub(7,"div",15),c.Ub(8,"label",19),c.Hc(9,"Mes"),c.Tb(),c.Pb(10,"p-dropdown",20),c.Fc(11,w,2,1,"div",18),c.Tb(),c.Tb(),c.Ub(12,"div",3),c.Ub(13,"div",15),c.Ub(14,"label",16),c.Hc(15,"Nuevo a\xf1o"),c.Tb(),c.Pb(16,"input",26),c.Fc(17,S,3,2,"div",18),c.Tb(),c.Ub(18,"div",15),c.Ub(19,"label",19),c.Hc(20,"Nuevo mes"),c.Tb(),c.Pb(21,"p-dropdown",27),c.Fc(22,I,2,1,"div",18),c.Tb(),c.Tb(),c.Ub(23,"div",1),c.Ub(24,"div",28),c.Ub(25,"button",22),c.cc("click",(function(){return c.xc(e),c.ec().clone()})),c.Pb(26,"i",23),c.Ub(27,"span"),c.Hc(28," Copiar"),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb()}if(2&e){const e=c.ec();c.kc("formGroup",e.cloneForm),c.Cb(6),c.kc("ngIf",e.cloneForm.controls.anno.invalid&&(e.cloneForm.controls.anno.dirty||e.cloneForm.controls.anno.touched)),c.Cb(4),c.kc("options",e.months)("showClear",!0),c.Cb(1),c.kc("ngIf",e.cloneForm.controls.mes.invalid&&(e.cloneForm.controls.mes.dirty||e.cloneForm.controls.mes.touched)),c.Cb(6),c.kc("ngIf",e.cloneForm.controls.newAnno.invalid&&(e.cloneForm.controls.newAnno.dirty||e.cloneForm.controls.newAnno.touched)),c.Cb(4),c.kc("options",e.months)("showClear",!0),c.Cb(1),c.kc("ngIf",e.cloneForm.controls.newMes.invalid&&(e.cloneForm.controls.newMes.dirty||e.cloneForm.controls.newMes.touched)),c.Cb(3),c.kc("disabled",e.cloneForm.pristine||e.cloneForm.invalid||e.loading),c.Cb(1),c.kc("ngClass",c.oc(11,E,!e.loading,e.loading))}}function R(e,t){if(1&e){const e=c.Vb();c.Ub(0,"div",33),c.Ub(1,"div",34),c.Ub(2,"div",6),c.Ub(3,"div",1),c.Ub(4,"div",2),c.Hc(5),c.Tb(),c.Ub(6,"div",21),c.Ub(7,"button",35),c.cc("click",(function(){c.xc(e);const o=t.$implicit;return c.ec(2).editTemplate(o.id)})),c.Pb(8,"i",36),c.Tb(),c.Ub(9,"button",37),c.cc("click",(function(){c.xc(e);const o=t.$implicit;return c.ec(2).confirm(o.id)})),c.Pb(10,"i",38),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb()}if(2&e){const e=t.$implicit,o=c.ec(2);c.Cb(5),c.Jc(" ",o.getMonth(e.mes)," ")}}function _(e,t){if(1&e){const e=c.Vb();c.Ub(0,"div"),c.Ub(1,"div",3),c.Ub(2,"div",29),c.Ub(3,"label",30),c.Hc(4,"Seleccione un a\xf1o:"),c.Tb(),c.Ub(5,"p-dropdown",31),c.cc("ngModelChange",(function(t){return c.xc(e),c.ec().selectedYear=t}))("onChange",(function(t){return c.xc(e),c.ec().selectYear(t)})),c.Tb(),c.Tb(),c.Tb(),c.Ub(6,"div",3),c.Fc(7,R,11,1,"div",32),c.Tb(),c.Tb()}if(2&e){const e=c.ec();c.Cb(5),c.kc("ngModel",e.selectedYear)("options",e.years),c.Cb(2),c.kc("ngForOf",e.templates)}}function A(e,t){1&e&&(c.Ub(0,"div",1),c.Ub(1,"div",40),c.Pb(2,"img",41),c.Tb(),c.Tb())}function N(e,t){if(1&e&&c.Fc(0,A,3,0,"div",39),2&e){const e=c.ec();c.kc("ngIf",!e.loading)}}let G=(()=>{class e{constructor(e,t,o,i,s,a){this.router=e,this.templateService=t,this.formBuilder=o,this.messageService=i,this.confirmationService=s,this.monthService=a,this.annoRegex=/^(\d{4})$/,this.optionCreation="A\xf1adir plantilla",this.months=this.monthService.getMonths()}ngOnInit(){this.getTemplates(),this.buildForm()}buildForm(){this.addForm=this.formBuilder.group({anno:new n.c("",[n.n.required,n.n.pattern(this.annoRegex)]),mes:new n.c("",n.n.required)}),this.cloneForm=this.formBuilder.group({anno:new n.c("",[n.n.required,n.n.pattern(this.annoRegex)]),mes:new n.c("",n.n.required),newAnno:new n.c("",[n.n.required,n.n.pattern(this.annoRegex)]),newMes:new n.c("",n.n.required)})}getTemplates(){Promise.resolve().then(()=>this.loading=!0),this.templateService.get().subscribe(e=>{this.templatesTotal=e.data,this.years=e.years,this.loading=!1,this.years&&this.years.length>0&&this.calculateTemplates(this.years[0])},()=>{this.loading=!1})}getMonth(e){return this.monthService.getMonths().find(t=>t.value===e).name}selectYear(e){this.calculateTemplates()}editTemplate(e){this.router.navigate(["/home/templates/"+e])}addTemplate(){const e=new r;e.anno=this.addForm.get("anno").value,e.mes=this.addForm.get("mes").value.value,Promise.resolve().then(()=>this.loading=!0),this.templateService.add(e).subscribe(e=>{let t=[...this.templatesTotal];t.push(e.data),this.templatesTotal=t,this.years=e.years,this.years&&this.years.length>0&&this.calculateTemplates(this.years[0]),this.loading=!1,this.messageService.add({severity:"success",summary:"\xc9xito",detail:e.message})},e=>{this.loading=!1,this.messageService.add({severity:"error",summary:"Error",detail:e.error.message})})}clone(){Promise.resolve().then(()=>this.loading=!0);const e={anno:this.cloneForm.get("anno").value,mes:this.cloneForm.get("mes").value.value,newAnno:this.cloneForm.get("newAnno").value,newMes:this.cloneForm.get("newMes").value.value};this.templateService.clone(e).subscribe(e=>{let t=[...this.templatesTotal];t.push(e.data),this.templatesTotal=t,this.years=e.years,this.calculateTemplates(),this.loading=!1,this.messageService.add({severity:"success",summary:"\xc9xito",detail:e.message})},e=>{this.loading=!1,this.messageService.add({severity:"error",summary:"Error",detail:e.error.message})})}calculateTemplates(e){this.selectedYear=e||this.selectedYear,this.templates=this.templatesTotal.filter(e=>e.anno===this.selectedYear.anno).sort((e,t)=>e.mes>t.mes?1:-1)}confirm(e){this.confirmationService.confirm({message:"\xbfEst\xe1s seguro de que deseas borrar?",header:"Confirmaci\xf3n",icon:"pi pi-exclamation-triangle",accept:()=>{this.delete(e)}})}delete(e){this.templateService.delete(e).subscribe(t=>{this.templatesTotal=this.templatesTotal.filter(t=>t.id!==e),this.templates=this.templates.filter(t=>t.id!==e),this.messageService.add({severity:"success",summary:"\xc9xito",detail:t.message}),this.years=t.years,this.years&&this.years.length>0&&this.calculateTemplates(this.years[0])},e=>{this.messageService.add({severity:"error",summary:"Error",detail:e.error.message})})}}return e.\u0275fac=function(t){return new(t||e)(c.Ob(a.b),c.Ob(d.a),c.Ob(n.b),c.Ob(l.d),c.Ob(l.a),c.Ob(b.a))},e.\u0275cmp=c.Ib({type:e,selectors:[["app-templates"]],decls:30,vars:6,consts:[[1,"wrapper"],[1,"row"],[1,"col-12"],[1,"row","mt-3"],[1,"card"],[1,"card-header","bg-primary","text-white"],[1,"card-body"],[1,"ui-g",2,"width","250px","margin-bottom","10px"],[1,"ui-g-12"],["name","group1","value","A\xf1adir plantilla","label","A\xf1adir plantilla","inputId","opt1",3,"ngModel","ngModelChange"],["name","group1","value","Copiar plantilla","label","Copiar plantilla","inputId","opt2",3,"ngModel","ngModelChange"],[3,"formGroup",4,"ngIf"],[4,"ngIf","ngIfElse"],["noTemplates",""],[3,"formGroup"],[1,"col-12","col-md-4","form-group"],["for","anno"],["type","number","id","anno","formControlName","anno",1,"form-control","form-control-user"],["class","alert alert-danger mt-1",4,"ngIf"],["for","mes"],["formControlName","mes","placeholder","Seleccione un mes","optionLabel","name",3,"options","showClear"],[1,"col-12","text-right"],["type","button",1,"btn","btn-primary",3,"disabled","click"],["aria-hidden","true",1,"fas",3,"ngClass"],[1,"alert","alert-danger","mt-1"],[4,"ngIf"],["type","number","id","anno","formControlName","newAnno",1,"form-control","form-control-user"],["formControlName","newMes","placeholder","Seleccione un mes","optionLabel","name",3,"options","showClear"],[1,"col-12","col-md-4","text-right"],[1,"col-12","col-md-3","form-group"],["for","exampleInputEmail1"],["optionLabel","anno","placeholder","Seleccione un a\xf1o",3,"ngModel","options","ngModelChange","onChange"],["class","col-12 col-md-4 col-xl-3 mt-3",4,"ngFor","ngForOf"],[1,"col-12","col-md-4","col-xl-3","mt-3"],[1,"card","bg-secondary","border","border-dark"],["type","button",1,"btn","btn-primary",3,"click"],["aria-hidden","true",1,"fas","fa-edit"],["type","button",1,"ml-1","btn","btn-primary",3,"click"],["aria-hidden","true",1,"fas","fa-trash"],["class","row",4,"ngIf"],[1,"col-12","col-lg-4","offset-lg-4","form-group"],["src","./assets/notfound.png","alt","No existen resultados",1,"d-block","mx-auto","img-not-found"]],template:function(e,t){if(1&e&&(c.Ub(0,"div",0),c.Ub(1,"div",1),c.Ub(2,"div",2),c.Ub(3,"h1"),c.Hc(4,"Plantillas"),c.Tb(),c.Tb(),c.Tb(),c.Pb(5,"hr"),c.Ub(6,"div",3),c.Ub(7,"div",2),c.Ub(8,"div",4),c.Ub(9,"div",5),c.Hc(10," Creador de plantillas "),c.Tb(),c.Ub(11,"div",6),c.Ub(12,"div",1),c.Ub(13,"div",2),c.Ub(14,"div",7),c.Ub(15,"div",8),c.Ub(16,"p-radioButton",9),c.cc("ngModelChange",(function(e){return t.optionCreation=e})),c.Tb(),c.Tb(),c.Ub(17,"div",8),c.Ub(18,"p-radioButton",10),c.cc("ngModelChange",(function(e){return t.optionCreation=e})),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Fc(19,y,18,10,"form",11),c.Fc(20,O,29,14,"form",11),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Ub(21,"div",3),c.Ub(22,"div",2),c.Ub(23,"div",4),c.Ub(24,"div",5),c.Hc(25," Listado de plantillas "),c.Tb(),c.Ub(26,"div",6),c.Fc(27,_,8,3,"div",12),c.Fc(28,N,1,1,"ng-template",null,13,c.Gc),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb()),2&e){const e=c.vc(29);c.Cb(16),c.kc("ngModel",t.optionCreation),c.Cb(2),c.kc("ngModel",t.optionCreation),c.Cb(1),c.kc("ngIf","A\xf1adir plantilla"===t.optionCreation),c.Cb(1),c.kc("ngIf","Copiar plantilla"===t.optionCreation),c.Cb(7),c.kc("ngIf",(null==t.templatesTotal?null:t.templatesTotal.length)>0)("ngIfElse",e)}},directives:[m.a,n.h,n.j,u.k,n.o,n.i,n.e,n.k,n.a,n.d,p.a,u.i,u.j],styles:[""]}),e})();var q=o("QVck"),$=o("mgSE"),L=o("itXk"),j=o("PTGG"),J=o("OS4P"),V=o("3iQZ"),D=o("/RsI"),X=o("kAuD"),Y=o("Ji6n");function z(e,t){if(1&e&&(c.Ub(0,"h1"),c.Hc(1),c.Tb()),2&e){const e=c.ec();c.Cb(1),c.Kc("Plantilla ",e.getMonth(e.template.mes)," ",e.template.anno,"")}}function B(e,t){1&e&&(c.Ub(0,"h1"),c.Hc(1,"Plantilla"),c.Tb())}function Z(e,t){1&e&&(c.Ub(0,"div",1),c.Pb(1,"img",12),c.Tb())}const K=function(){return["/home/expenses/new"]};function Q(e,t){1&e&&(c.Ub(0,"div",25),c.Hc(1," Si desea a\xf1adir un nuevo gasto acceda "),c.Ub(2,"a",26),c.Hc(3,"gastos"),c.Tb(),c.Tb()),2&e&&(c.Cb(2),c.kc("routerLink",c.mc(1,K)))}const W=function(){return["/home/profits/new"]};function ee(e,t){1&e&&(c.Ub(0,"div",25),c.Hc(1," Si desea a\xf1adir una nueva ganancia acceda "),c.Ub(2,"a",26),c.Hc(3,"ganancias"),c.Tb(),c.Tb()),2&e&&(c.Cb(2),c.kc("routerLink",c.mc(1,W)))}function te(e,t){if(1&e){const e=c.Vb();c.Ub(0,"div",13),c.Ub(1,"div",14),c.Hc(2," Gestor de recursos "),c.Tb(),c.Ub(3,"div",15),c.Ub(4,"div",16),c.Ub(5,"div",17),c.Ub(6,"label",18),c.Hc(7,"Tipo de recurso"),c.Tb(),c.Ub(8,"p-dropdown",19),c.cc("onChange",(function(t){return c.xc(e),c.ec().selectResource(t)})),c.Tb(),c.Tb(),c.Ub(9,"div",17),c.Ub(10,"label",18),c.Hc(11,"Recurso"),c.Tb(),c.Ub(12,"p-dropdown",20),c.cc("ngModelChange",(function(t){return c.xc(e),c.ec().selectedResource=t})),c.Tb(),c.Tb(),c.Fc(13,Q,4,2,"div",21),c.Fc(14,ee,4,2,"div",21),c.Tb(),c.Ub(15,"div",1),c.Ub(16,"div",22),c.Ub(17,"button",23),c.cc("click",(function(){return c.xc(e),c.ec().addResouce()})),c.Pb(18,"i",24),c.Ub(19,"span"),c.Hc(20," A\xf1adir recurso"),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb()}if(2&e){const e=c.ec();c.Cb(8),c.kc("options",e.types),c.Cb(4),c.kc("options",e.resources)("ngModel",e.selectedResource),c.Cb(1),c.kc("ngIf",!e.isProfit),c.Cb(1),c.kc("ngIf",e.isProfit),c.Cb(3),c.kc("disabled",!e.selectedResource||""===e.selectedResource)}}function oe(e,t){if(1&e){const e=c.Vb();c.Ub(0,"div",39),c.Ub(1,"div",40),c.Hc(2),c.Tb(),c.Ub(3,"div",41),c.Ub(4,"input",42),c.cc("input",(function(){return c.xc(e),c.ec(2).calculate()}))("ngModelChange",(function(o){return c.xc(e),t.$implicit.cantidad=o})),c.Tb(),c.Tb(),c.Ub(5,"div",43),c.Ub(6,"button",44),c.cc("click",(function(){c.xc(e);const o=t.$implicit;return c.ec(2).deleteRevenue(o.id)})),c.Pb(7,"i",45),c.Tb(),c.Tb(),c.Tb()}if(2&e){const e=t.$implicit;c.Cb(2),c.Jc(" ",e.ganancia_id.nombre," "),c.Cb(2),c.kc("ngModel",e.cantidad)}}function ie(e,t){if(1&e){const e=c.Vb();c.Ub(0,"div",39),c.Ub(1,"div",40),c.Hc(2),c.Tb(),c.Ub(3,"div",41),c.Ub(4,"input",42),c.cc("input",(function(){return c.xc(e),c.ec(3).calculate()}))("ngModelChange",(function(t){return c.xc(e),c.ec().$implicit.cantidad=t})),c.Tb(),c.Tb(),c.Ub(5,"div",47),c.Ub(6,"p-checkbox",48),c.cc("ngModelChange",(function(t){return c.xc(e),c.ec().$implicit.pagado=t})),c.Tb(),c.Tb(),c.Ub(7,"div",49),c.Ub(8,"button",44),c.cc("click",(function(){c.xc(e);const t=c.ec().$implicit;return c.ec(2).deletePayment(t.id)})),c.Pb(9,"i",45),c.Tb(),c.Tb(),c.Tb()}if(2&e){const e=c.ec().$implicit;c.Cb(2),c.Jc(" ",e.gasto_id.nombre," "),c.Cb(2),c.kc("ngModel",e.cantidad),c.Cb(2),c.kc("ngModel",e.pagado)}}function se(e,t){if(1&e&&(c.Ub(0,"div"),c.Fc(1,ie,10,3,"div",46),c.Tb()),2&e){const e=t.$implicit;c.Cb(1),c.kc("ngIf","Mensuales Primarios"===e.gasto_id.id_tipo_gasto.valor)}}function ae(e,t){if(1&e){const e=c.Vb();c.Ub(0,"div",39),c.Ub(1,"div",40),c.Hc(2),c.Tb(),c.Ub(3,"div",41),c.Ub(4,"input",42),c.cc("input",(function(){return c.xc(e),c.ec(3).calculate()}))("ngModelChange",(function(t){return c.xc(e),c.ec().$implicit.cantidad=t})),c.Tb(),c.Tb(),c.Ub(5,"div",47),c.Ub(6,"p-checkbox",48),c.cc("ngModelChange",(function(t){return c.xc(e),c.ec().$implicit.pagado=t})),c.Tb(),c.Tb(),c.Ub(7,"div",50),c.Ub(8,"button",44),c.cc("click",(function(){c.xc(e);const t=c.ec().$implicit;return c.ec(2).deletePayment(t.id)})),c.Pb(9,"i",45),c.Tb(),c.Tb(),c.Tb()}if(2&e){const e=c.ec().$implicit;c.Cb(2),c.Jc(" ",e.gasto_id.nombre," "),c.Cb(2),c.kc("ngModel",e.cantidad),c.Cb(2),c.kc("ngModel",e.pagado)}}function ne(e,t){if(1&e&&(c.Ub(0,"div"),c.Fc(1,ae,10,3,"div",46),c.Tb()),2&e){const e=t.$implicit;c.Cb(1),c.kc("ngIf","Mensuales Secundarios"===e.gasto_id.id_tipo_gasto.valor)}}function re(e,t){if(1&e){const e=c.Vb();c.Ub(0,"div",27),c.Ub(1,"div",14),c.Hc(2," Plantilla "),c.Tb(),c.Ub(3,"div",15),c.Ub(4,"div",1),c.Ub(5,"div",2),c.Hc(6," La plantilla se gestiona de forma autom\xe1tica a trav\xe9s del m\xe9todo 50/30/20 "),c.Ub(7,"a",28),c.cc("click",(function(){return c.xc(e),c.ec().openInfo()})),c.Pb(8,"i",29),c.Tb(),c.Hc(9,". "),c.Tb(),c.Tb(),c.Ub(10,"div",30),c.Ub(11,"div",31),c.Hc(12," Nombre "),c.Tb(),c.Ub(13,"div",31),c.Hc(14," Valor "),c.Tb(),c.Ub(15,"div",31),c.Hc(16," Opciones "),c.Tb(),c.Tb(),c.Ub(17,"div",32),c.Ub(18,"div",33),c.Hc(19," Ingresos "),c.Tb(),c.Ub(20,"div",33),c.Hc(21),c.Tb(),c.Pb(22,"div",34),c.Tb(),c.Fc(23,oe,8,2,"div",35),c.Ub(24,"div",36),c.Ub(25,"div",33),c.Hc(26," Disponible Gastos primarios "),c.Tb(),c.Ub(27,"div",33),c.Hc(28),c.Tb(),c.Pb(29,"div",34),c.Tb(),c.Fc(30,se,2,1,"div",37),c.Ub(31,"div",36),c.Ub(32,"div",33),c.Hc(33," Disponible Gastos secundarios "),c.Tb(),c.Ub(34,"div",33),c.Hc(35),c.Tb(),c.Pb(36,"div",34),c.Tb(),c.Fc(37,ne,2,1,"div",37),c.Ub(38,"div",36),c.Ub(39,"div",33),c.Hc(40," Ahorros esperados "),c.Tb(),c.Ub(41,"div",33),c.Hc(42),c.Tb(),c.Pb(43,"div",34),c.Tb(),c.Ub(44,"div",36),c.Ub(45,"div",33),c.Hc(46," Ahorros reales "),c.Tb(),c.Ub(47,"div",33),c.Hc(48),c.Tb(),c.Pb(49,"div",34),c.Tb(),c.Ub(50,"div",8),c.Ub(51,"div",2),c.Ub(52,"button",9),c.cc("click",(function(){return c.xc(e),c.ec().save()})),c.Pb(53,"i",38),c.Ub(54,"span"),c.Hc(55," Guardar"),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb()}if(2&e){const e=c.ec();c.Cb(21),c.Jc(" ",e.revenues," "),c.Cb(2),c.kc("ngForOf",e.template.ingresos),c.Cb(5),c.Jc(" ",e.primaryExpenses," "),c.Cb(2),c.kc("ngForOf",e.template.pagos),c.Cb(5),c.Jc(" ",e.secondaryExpenses," "),c.Cb(2),c.kc("ngForOf",e.template.pagos),c.Cb(5),c.Jc(" ",e.promiseSavings," "),c.Cb(6),c.Jc(" ",e.realSavings," ")}}const ce=function(e,t){return{"alert-success":e,"alert-danger":t}};function de(e,t){if(1&e&&(c.Ub(0,"div",56),c.Hc(1),c.Tb()),2&e){const e=t.$implicit;c.kc("ngClass",c.oc(2,ce,e.status,!e.status)),c.Cb(1),c.Jc(" ",e.message," ")}}function le(e,t){if(1&e&&(c.Ub(0,"div"),c.Fc(1,de,2,5,"div",55),c.Tb()),2&e){const e=c.ec(2);c.Cb(1),c.kc("ngForOf",e.tips)}}function be(e,t){1&e&&(c.Ub(0,"div",57),c.Hc(1," Debes a\xf1adir ingresos o gastos para recibir tips. "),c.Tb())}function me(e,t){if(1&e&&(c.Ub(0,"div",56),c.Hc(1),c.Tb()),2&e){const e=t.$implicit;c.kc("ngClass",c.oc(2,ce,e.status,!e.status)),c.Cb(1),c.Jc(" ",e.message," ")}}function ue(e,t){if(1&e&&(c.Ub(0,"div"),c.Fc(1,me,2,5,"div",55),c.Tb()),2&e){const e=c.ec(2);c.Cb(1),c.kc("ngForOf",e.goodPracticesUsed)}}function pe(e,t){1&e&&(c.Ub(0,"div",57),c.Hc(1," No existen buenas pr\xe1cticas que aplicar "),c.Tb())}function ge(e,t){if(1&e&&(c.Ub(0,"div",16),c.Ub(1,"div",51),c.Ub(2,"div",13),c.Ub(3,"div",14),c.Hc(4," Tips "),c.Tb(),c.Ub(5,"div",15),c.Fc(6,le,2,1,"div",52),c.Fc(7,be,2,0,"ng-template",null,53,c.Gc),c.Tb(),c.Tb(),c.Tb(),c.Ub(9,"div",51),c.Ub(10,"div",13),c.Ub(11,"div",14),c.Hc(12," Buenas pr\xe1cticas "),c.Tb(),c.Ub(13,"div",15),c.Fc(14,ue,2,1,"div",52),c.Fc(15,pe,2,0,"ng-template",null,54,c.Gc),c.Tb(),c.Tb(),c.Tb(),c.Tb()),2&e){const e=c.vc(8),t=c.vc(16),o=c.ec();c.Cb(6),c.kc("ngIf",(null==o.tips?null:o.tips.length)>0)("ngIfElse",e),c.Cb(8),c.kc("ngIf",(null==o.goodPracticesUsed?null:o.goodPracticesUsed.length)>0)("ngIfElse",t)}}const he=function(){return{width:"75vw"}},fe=[{path:"",component:G},{path:":id",component:(()=>{class e{constructor(e,t,o,i,s,a,n,r){this.activatedRoute=e,this.location=t,this.templateService=o,this.monthService=i,this.expenseService=s,this.profitService=a,this.messageService=n,this.goodPracticeService=r,this.isProfit=!0,this.revenues=0,this.primaryExpenses=0,this.secondaryExpenses=0,this.promiseSavings=0,this.realSavings=0,this.goodPractices=[],this.goodPracticesUsed=[],this.tips=[],this.display=!1,this.types=[{name:"Ingresos",code:"ingresos"},{name:"Gastos primarios",code:"gastos-primarios"},{name:"Gastos secundarios",code:"gastos-secundarios"}]}ngOnInit(){Promise.resolve().then(()=>this.loading=!0),Object(L.a)(this.getPrimaryMonthlyExpenses(),this.getSecondaryMonthlyExpenses(),this.getMonthlyProfits(),this.getGoodPractices(),this.getTemplate()).subscribe(([e,t,o,i,s])=>{this.primaryMonthlyExpenses=e.data,this.secondaryMonthlyExpenses=t.data,this.monthlyProfits=o.data,this.resources=this.monthlyProfits,this.goodPractices=i.data,this.template=s.data,this.loading=!1,this.calculate()},e=>{this.loading=!1,this.messageService.add({severity:"error",summary:"Error",detail:e.error.message})})}getTemplate(){return this.templateService.find(this.activatedRoute.snapshot.params.id)}getPrimaryMonthlyExpenses(){return this.expenseService.findAllPrimaryMonthlyExpenses(this.activatedRoute.snapshot.params.id)}getSecondaryMonthlyExpenses(){return this.expenseService.findAllSecondaryMonthlyExpenses(this.activatedRoute.snapshot.params.id)}getMonthlyProfits(){return this.profitService.findAllMonthlyProfits()}getGoodPractices(){return this.goodPracticeService.findAll()}selectResource(e){"ingresos"==e.value.code?(this.resources=this.monthlyProfits,this.isProfit=!0):"gastos-primarios"==e.value.code?(this.resources=this.primaryMonthlyExpenses,this.isProfit=!1):"gastos-secundarios"==e.value.code&&(this.resources=this.secondaryMonthlyExpenses,this.isProfit=!1),this.selectedResource=null}back(){this.location.back()}getMonth(e){return this.monthService.getMonth(e)}addResouce(){if(this.selectedResource.id_tipo_ganancia)if(this.template.ingresos.filter(e=>e.id===this.selectedResource.id).length>0)this.messageService.add({severity:"error",summary:"Error",detail:"La ganancia ya est\xe1 a\xf1adida en la plantilla"});else{const e=new $.a;e.ganancia_id=this.selectedResource,e.cantidad=0,e.plantilla_id=this.template.id,e.id=this.selectedResource.id,this.template.ingresos.push(e),this.messageService.add({severity:"success",summary:"\xc9xito",detail:"Se ha a\xf1adido el ingreso. Recuerda introducir un valor"})}else if(this.template.pagos.filter(e=>e.id===this.selectedResource.id).length>0)this.messageService.add({severity:"error",summary:"Error",detail:"El gasto ya est\xe1 a\xf1adido en la plantilla"});else{const e=new q.a;e.gasto_id=this.selectedResource,e.cantidad=0,e.pagado=0,e.plantilla_id=this.template.id,e.id=this.selectedResource.id,this.template.pagos.push(e),this.messageService.add({severity:"success",summary:"\xc9xito",detail:"Se ha a\xf1adido el pago. Recuerda introducir un valor"})}this.calculateTips()}deletePayment(e){this.template.pagos=this.template.pagos.filter(t=>t.id!==e),this.calculate()}deleteRevenue(e){this.template.ingresos=this.template.ingresos.filter(t=>t.id!==e),this.calculate()}save(){if(0===this.template.pagos.length&&0===this.template.ingresos.length)this.messageService.add({severity:"error",summary:"Error",detail:"Se debe a\xf1adir al menos un gasto o ingreso"});else{const e=this.template.pagos.find(e=>null==e.cantidad||0===e.cantidad),t=this.template.ingresos.find(e=>null==e.cantidad||0===e.cantidad);e||t?this.messageService.add({severity:"error",summary:"Error",detail:"El campo valor no puede estar vac\xedo o ser 0"}):(this.template.pagos.forEach(e=>e.cantidad=+e.cantidad),this.template.ingresos.forEach(e=>e.cantidad=+e.cantidad),this.templateService.update(this.template).subscribe(e=>{this.messageService.add({severity:"success",summary:"\xc9xito",detail:"Se ha actualizado la plantilla"})},e=>{this.messageService.add({severity:"error",summary:"Error",detail:"No se ha podido actualizar la plantilla"})}))}}calculate(){this.calculateTemplate(),this.calculateGoodPractices(),this.calculateTips()}calculateTemplate(){this.revenues=this.template.ingresos.length>0?this.template.ingresos.map(e=>e.cantidad).reduce((e,t)=>e+t):0;const e=this.template.pagos.filter(e=>"Mensuales Primarios"===e.gasto_id.id_tipo_gasto.valor);let t=0;e.length>0&&(t=e.map(e=>e.cantidad).reduce((e,t)=>parseFloat(e.toString())+parseFloat(t.toString())));const o=this.template.pagos.filter(e=>"Mensuales Secundarios"===e.gasto_id.id_tipo_gasto.valor);let i=0;o.length>0&&(i=o.map(e=>e.cantidad).reduce((e,t)=>parseFloat(e.toString())+parseFloat(t.toString()))),this.primaryExpenses=Number((.5*this.revenues-t).toFixed(2)),this.secondaryExpenses=Number((.3*this.revenues-i).toFixed(2)),this.promiseSavings=Number((.2*this.revenues).toFixed(2)),this.realSavings=Number((this.promiseSavings+this.primaryExpenses+this.secondaryExpenses).toFixed(2))}calculateGoodPractices(){if(this.template.pagos.length>0){this.goodPracticesUsed=[];for(let e of this.goodPractices){const t=this.template.pagos.find(t=>e.palabra_clave===t.gasto_id.nombre),o=.01*e.porcentaje*this.revenues;t&&this.goodPracticesUsed.push(t.cantidad>o?{message:"Es recomendable no sobrepasar el "+e.porcentaje+"% de los ingresos en el gasto del "+e.palabra_clave,status:!1}:{message:"No sobrepasas el "+e.porcentaje+"% de los ingresos en el gasto del "+e.palabra_clave,status:!0})}}}calculateTips(){this.tips=[],(this.template.ingresos.length>0||this.template.pagos.length>0)&&(0!==this.promiseSavings&&this.tips.push(this.promiseSavings<this.realSavings?{message:"Perfecto! Ahorras este mes m\xe1s de lo esperado",status:!0}:{message:"No es aconsejable ahorrar menos de lo esperado",status:!1}),this.tips.push(this.realSavings<=0?{message:"Este mes no es bueno dado que no has ahorrado",status:!1}:{message:"Felicidades! Has ahorrado este mes",status:!0}),this.tips.push(this.primaryExpenses<0?{message:"Este mes sobrepasas el dinero establecido para gastos primarios",status:!1}:{message:"Perfecto! No sobrepasas los gastos primarios",status:!0}),this.tips.push(this.secondaryExpenses<0?{message:"Este mes sobrepasas el dinero establecido para gastos secundarios",status:!1}:{message:"Perfecto! No sobrepasas los gastos secundarios",status:!0}))}openInfo(){this.display=!0}}return e.\u0275fac=function(t){return new(t||e)(c.Ob(a.a),c.Ob(u.g),c.Ob(d.a),c.Ob(b.a),c.Ob(j.a),c.Ob(J.a),c.Ob(l.d),c.Ob(V.a))},e.\u0275cmp=c.Ib({type:e,selectors:[["app-create-template"]],decls:26,vars:14,consts:[[1,"wrapper"],[1,"row"],[1,"col-12"],[4,"ngIf"],["class","row",4,"ngIf"],["class","card",4,"ngIf"],["class","card mt-3",4,"ngIf"],["class","row mt-3",4,"ngIf"],[1,"row","mt-3","text-right"],["type","button",1,"btn","btn-primary",3,"click"],["aria-hidden","true",1,"fas","fa-arrow-left"],["header","M\xe9todo 50/30/20",3,"visible","modal","baseZIndex","draggable","resizable","visibleChange"],["src","./assets/notfound.png","alt","No existen resultados",1,"d-block","mx-auto","img-not-found"],[1,"card"],[1,"card-header","bg-primary","text-white"],[1,"card-body"],[1,"row","mt-3"],[1,"form-group","col-12","col-md-6"],["for","exampleInputPassword1"],["optionLabel","name",3,"options","onChange"],["optionLabel","nombre","placeholder","Elige el recurso...",3,"options","ngModel","ngModelChange"],["class","form-group offset-md-6 col-12 col-md-3",4,"ngIf"],[1,"form-group","col-12","text-right"],["type","button",1,"btn","btn-primary",3,"disabled","click"],["aria-hidden","true",1,"fas","fa-plus"],[1,"form-group","offset-md-6","col-12","col-md-3"],[3,"routerLink"],[1,"card","mt-3"],[3,"click"],[1,"fas","fa-question-circle"],[1,"row","mx-1","mt-3","d-none","d-md-flex"],[1,"col-12","col-md-4","p-2","text-center","border","border-dark"],[1,"row","mx-1","text-white","mt-3","mt-md-0"],[1,"fixed-row","col-12","col-md-4","p-2","text-center","border","border-dark"],[1,"fixed-row","col-12","col-md-4","p-2","text-center","border","border-dark","d-none","d-md-block"],["class","row mx-1",4,"ngFor","ngForOf"],[1,"row","mx-1","text-white"],[4,"ngFor","ngForOf"],["aria-hidden","true",1,"fas","fa-save"],[1,"row","mx-1"],[1,"resource-row","col-12","col-md-4","text-center","border","border-dark","d-flex","justify-content-center","align-items-center","py-2","py-md-0"],[1,"resource-row","col-12","col-md-4","text-center","border","border-dark","py-2","py-md-0"],["type","textbox","placeholder","XX.XX","appTwoDigitDecimaNumber","",1,"form-control","form-control-user",3,"ngModel","input","ngModelChange"],[1,"resource-row","col-12","col-md-4","text-center","border","border-dark","border-left-0","py-2","py-md-0"],["type","button",1,"btn","btn-primary","btn-sm","mt-1",3,"click"],["aria-hidden","true",1,"fas","fa-trash-alt"],["class","row mx-1",4,"ngIf"],[1,"resource-row","col-6","col-md-2","text-center","border","border-dark","border-right-0","d-flex","justify-content-center","align-items-center","py-2","py-md-0"],["name","groupname","binary","true","label","Pagado",3,"ngModel","ngModelChange"],[1,"resource-row","col-6","col-md-2","primary-expense-item","text-center","border","border-dark","border-left-0","py-2","py-md-0"],[1,"resource-row","col-6","col-md-2","text-center","border","border-dark","border-left-0"],[1,"col-12","col-md-6","mt-3","mt-md-0"],[4,"ngIf","ngIfElse"],["noTips",""],["noGoodPractice",""],["class","alert text-dark","role","alert",3,"ngClass",4,"ngFor","ngForOf"],["role","alert",1,"alert","text-dark",3,"ngClass"],["role","alert",1,"alert","alert-secondary"]],template:function(e,t){1&e&&(c.Ub(0,"div",0),c.Ub(1,"div",1),c.Ub(2,"div",2),c.Fc(3,z,2,2,"h1",3),c.Fc(4,B,2,0,"h1",3),c.Tb(),c.Tb(),c.Pb(5,"hr"),c.Fc(6,Z,2,0,"div",4),c.Fc(7,te,21,6,"div",5),c.Fc(8,re,56,8,"div",6),c.Fc(9,ge,17,4,"div",7),c.Ub(10,"div",8),c.Ub(11,"div",2),c.Ub(12,"button",9),c.cc("click",(function(){return t.back()})),c.Pb(13,"i",10),c.Ub(14,"span"),c.Hc(15," Volver"),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Ub(16,"p-dialog",11),c.cc("visibleChange",(function(e){return t.display=e})),c.Hc(17," Este m\xe9todo de ahorro consiste en: "),c.Ub(18,"ul"),c.Ub(19,"li"),c.Hc(20,"El 50% de los ingresos destinados para gastos primarios, es decir, aquellos primordiales todos los meses "),c.Tb(),c.Ub(21,"li"),c.Hc(22,"El 30% de los ingresos destinados para gastos secundarios, es decir, aquellos como caprichos o gastos del d\xeda a d\xeda"),c.Tb(),c.Ub(23,"li"),c.Hc(24,"El 20% de los ingresos destinados para ahorros"),c.Tb(),c.Tb(),c.Hc(25," De esta forma, la aplicaci\xf3n se encarga de gestionar tus ingresos y pagos de cada mes.\n"),c.Tb()),2&e&&(c.Cb(3),c.kc("ngIf",t.template),c.Cb(1),c.kc("ngIf",!t.template),c.Cb(2),c.kc("ngIf",!t.template&&!t.loading),c.Cb(1),c.kc("ngIf",t.template),c.Cb(1),c.kc("ngIf",t.template),c.Cb(1),c.kc("ngIf",t.template),c.Cb(7),c.Dc(c.mc(13,he)),c.kc("visible",t.display)("modal",!0)("baseZIndex",1e4)("draggable",!1)("resizable",!1))},directives:[u.k,D.a,p.a,n.h,n.j,a.d,u.j,n.a,X.a,Y.a,u.i],styles:[".fixed-row[_ngcontent-%COMP%]{background-color:#46545c}.resource-row[_ngcontent-%COMP%]{background-color:#f0b153}input[_ngcontent-%COMP%], input[_ngcontent-%COMP%]:focus{background:#f0b153;text-align:center;border:none!important;box-shadow:none}"]}),e})()}];let ve=(()=>{class e{}return e.\u0275mod=c.Mb({type:e}),e.\u0275inj=c.Lb({factory:function(t){return new(t||e)},imports:[[a.e.forChild(fe)],a.e]}),e})();o.d(t,"TemplatesModule",(function(){return Te}));let Te=(()=>{class e{}return e.\u0275mod=c.Mb({type:e}),e.\u0275inj=c.Lb({factory:function(t){return new(t||e)},imports:[[i.a,s.a,ve]]}),e})()}}]);