function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{vnru:function(t,e,n){"use strict";n.r(e);var i,a=n("PCNd"),r=n("tyNb"),o=n("3Pt+"),c=n("fXoL"),s=n("AytR"),d=n("tk/3"),b=((i=function(){function t(e){_classCallCheck(this,t),this.http=e,this.url=s.a.url+"meta-ahorros",this.urlYearlySaving=s.a.url+"ahorros-anuales"}return _createClass(t,[{key:"get",value:function(t,e,n,i){var a=[],r="";return t.anno&&a.push("anno="+t.anno),e&&(a.push("sortable="+e),n&&a.push(1===n?"orderBy=asc":"orderBy=desc")),i&&a.push("page="+i),a.length>0&&(r="?"+a.join("&")),this.http.get(this.url+r)}},{key:"find",value:function(t){return this.http.get(this.url+"/"+t)}},{key:"add",value:function(t){return this.http.post(this.url,t)}},{key:"update",value:function(t,e){return this.http.put(this.url+"/"+e,t)}},{key:"delete",value:function(t){return this.http.delete(this.url+"/"+t)}},{key:"getYearlySaving",value:function(){return this.http.get(this.urlYearlySaving)}}]),t}()).\u0275fac=function(t){return new(t||i)(c.Yb(d.b))},i.\u0275prov=c.Kb({token:i,factory:i.\u0275fac,providedIn:"root"}),i),u=n("7zfz"),l=n("ofXK"),f=n("rEr+"),v=n("jIHw");function m(t,e){if(1&t&&c.Pb(0,"p-sortIcon",21),2&t){var n=c.ec().$implicit;c.kc("field",n.field)}}function g(t,e){if(1&t&&(c.Ub(0,"th",19),c.Hc(1),c.Fc(2,m,1,1,"p-sortIcon",20),c.Tb()),2&t){var n=e.$implicit;c.kc("pSortableColumn",n.field),c.Cb(1),c.Jc(" ",n.header," "),c.Cb(1),c.kc("ngIf",n.sortOrder)}}function p(t,e){if(1&t&&(c.Ub(0,"tr"),c.Fc(1,g,3,3,"th",18),c.Tb()),2&t){var n=e.$implicit;c.Cb(1),c.kc("ngForOf",n)}}function h(t,e){1&t&&(c.Ub(0,"span"),c.Hc(1,"SUPERADO"),c.Tb()),2&t&&c.Eb("customer-badge status-qualified")}function k(t,e){1&t&&(c.Ub(0,"span"),c.Hc(1,"NO SUPERADO"),c.Tb()),2&t&&c.Eb("customer-badge status-unqualified")}function y(t,e){if(1&t){var n=c.Vb();c.Ub(0,"tr",22),c.Ub(1,"td"),c.Ub(2,"span",23),c.Hc(3,"A\xf1o"),c.Tb(),c.Hc(4),c.Tb(),c.Ub(5,"td"),c.Ub(6,"span",23),c.Hc(7,"Cantidad"),c.Tb(),c.Hc(8),c.Tb(),c.Ub(9,"td"),c.Ub(10,"span",23),c.Hc(11,"Ahorrado"),c.Tb(),c.Hc(12),c.Tb(),c.Ub(13,"td"),c.Fc(14,h,2,2,"span",24),c.Fc(15,k,2,2,"span",24),c.Tb(),c.Ub(16,"td"),c.Ub(17,"button",25),c.cc("click",(function(){c.xc(n);var t=e.$implicit;return c.ec().onRowSelect(t.id)})),c.Ub(18,"span"),c.Pb(19,"i",26),c.Tb(),c.Tb(),c.Ub(20,"button",25),c.cc("click",(function(){c.xc(n);var t=e.$implicit;return c.ec().confirm(t.id)})),c.Ub(21,"span"),c.Pb(22,"i",27),c.Tb(),c.Tb(),c.Tb(),c.Tb()}if(2&t){var i=e.$implicit,a=c.ec();c.kc("pSelectableRow",i),c.Cb(4),c.Jc(" ",i.anno," "),c.Cb(4),c.Jc(" ",i.cantidad," "),c.Cb(4),c.Jc(" ",a.getSavings(i.anno)," "),c.Cb(2),c.kc("ngIf",a.getStatus(i.cantidad,i.anno)),c.Cb(1),c.kc("ngIf",!a.getStatus(i.cantidad,i.anno))}}function T(t,e){if(1&t){var n=c.Vb();c.Ub(0,"div",28),c.Ub(1,"button",29),c.cc("click",(function(){return c.xc(n),c.ec().add()})),c.Tb(),c.Tb()}}var U,C=function(t,e){return{"fa-search":t,"fa-spinner fa-spin":e}},S=((U=function(){function t(e,n,i,a,r){_classCallCheck(this,t),this.metaSavingService=e,this.formBuilder=n,this.messageService=i,this.confirmationService=a,this.router=r,this.cols=[{field:"anno",header:"A\xf1o",sortOrder:!0},{field:"cantidad",header:"Objetivo",sortOrder:!0},{field:"",header:"Ahorrado",sortOrder:!1},{field:"",header:"Estado",sortOrder:!1},{field:"",header:"Opciones",sortOrder:!1}],this.statuses=[{label:"No superado",value:"no-superado"},{label:"Superado",value:"superado"}]}return _createClass(t,[{key:"ngOnInit",value:function(){this.getYearlySaving(),this.buildForm()}},{key:"getYearlySaving",value:function(){var t=this;this.metaSavingService.getYearlySaving().subscribe((function(e){t.pagos=e.pagos,t.ingresos=e.ingresos}))}},{key:"getSavings",value:function(t){var e=this.pagos.find((function(e){return e.anno===t})),n=this.ingresos.find((function(e){return e.anno===t})),i=e?this.pagos.find((function(e){return e.anno===t})).total:0;return((n?this.ingresos.find((function(e){return e.anno===t})).total:0)-i).toFixed(2)}},{key:"getStatus",value:function(t,e){var n=this.pagos.find((function(t){return t.anno===e})),i=this.ingresos.find((function(t){return t.anno===e})),a=n?this.pagos.find((function(t){return t.anno===e})).total:0;return t<=(i?this.ingresos.find((function(t){return t.anno===e})).total:0)-a}},{key:"buildForm",value:function(){this.form=this.formBuilder.group({anno:new o.c("")})}},{key:"add",value:function(){this.router.navigate(["/home/objectives/new"])}},{key:"search",value:function(t,e,n){var i=this;Promise.resolve().then((function(){return i.loading=!0})),this.metaSavingService.get(this.form.value,t,e,n).subscribe((function(t){i.metasSaving=t.data.data,i.totalRecords=t.data.total,i.loading=!1}),(function(){i.loading=!1}))}},{key:"customSort",value:function(t){this.search(t.sortField,t.sortOrder,t.first/t.rows+1)}},{key:"confirm",value:function(t){var e=this;this.confirmationService.confirm({message:"\xbfEst\xe1s seguro de que deseas borrar?",header:"Confirmaci\xf3n",icon:"pi pi-exclamation-triangle",accept:function(){e.delete(t)}})}},{key:"delete",value:function(t){var e=this;this.metaSavingService.delete(t).subscribe((function(n){e.metasSaving=e.metasSaving.filter((function(e){return e.id!==t})),e.messageService.add({severity:"success",summary:"\xc9xito",detail:n.message})}),(function(t){e.messageService.add({severity:"error",summary:"Error",detail:t.error.message})}))}},{key:"onRowSelect",value:function(t){this.router.navigate(["/home/objectives/"+t])}}]),t}()).\u0275fac=function(t){return new(t||U)(c.Ob(b),c.Ob(o.b),c.Ob(u.d),c.Ob(u.a),c.Ob(r.b))},U.\u0275cmp=c.Ib({type:U,selectors:[["app-meta-saving"]],decls:34,vars:13,consts:[[1,"wrapper"],[1,"row"],[1,"col-12"],[1,"card","mt-3"],[1,"card-header","bg-primary","text-white"],[1,"card-body"],[3,"formGroup"],[1,"col-12","col-md-6","form-group"],["for","anno"],["type","text","id","anno","formControlName","anno",1,"form-control","form-control-user"],[1,"row","mt-1"],[1,"col-12","text-right","mt-2"],["type","button",1,"btn","btn-primary","mr-1",3,"disabled","click"],["aria-hidden","true",1,"fas",3,"ngClass"],[3,"columns","value","paginator","rows","responsive","lazy","totalRecords","onLazyLoad"],["pTemplate","header"],["pTemplate","body"],["pTemplate","summary"],[3,"pSortableColumn",4,"ngFor","ngForOf"],[3,"pSortableColumn"],[3,"field",4,"ngIf"],[3,"field"],[3,"pSelectableRow"],[1,"ui-column-title"],[3,"class",4,"ngIf"],["type","button",1,"btn","btn-secondary","mr-1",3,"click"],["aria-hidden","true",1,"fas","fa-edit"],["aria-hidden","true",1,"fas","fa-trash"],[2,"text-align","left"],["type","button","pButton","","icon","pi pi-plus","label","A\xf1adir",3,"click"]],template:function(t,e){1&t&&(c.Ub(0,"div",0),c.Ub(1,"div",1),c.Ub(2,"div",2),c.Ub(3,"h1"),c.Hc(4,"Objetivos"),c.Tb(),c.Tb(),c.Tb(),c.Pb(5,"hr"),c.Ub(6,"div",3),c.Ub(7,"div",4),c.Hc(8," Buscador de objetivos "),c.Tb(),c.Ub(9,"div",5),c.Ub(10,"div",1),c.Ub(11,"div",2),c.Ub(12,"form",6),c.Ub(13,"div",1),c.Ub(14,"div",7),c.Ub(15,"label",8),c.Hc(16,"A\xf1o"),c.Tb(),c.Pb(17,"input",9),c.Tb(),c.Tb(),c.Ub(18,"div",10),c.Ub(19,"div",11),c.Ub(20,"button",12),c.cc("click",(function(){return e.search()})),c.Pb(21,"i",13),c.Ub(22,"span"),c.Hc(23," Buscar"),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Ub(24,"div",3),c.Ub(25,"div",4),c.Hc(26," Listado de objetivos "),c.Tb(),c.Ub(27,"div",5),c.Ub(28,"div",1),c.Ub(29,"div",2),c.Ub(30,"p-table",14),c.cc("onLazyLoad",(function(t){return e.customSort(t)})),c.Fc(31,p,2,1,"ng-template",15),c.Fc(32,y,23,6,"ng-template",16),c.Fc(33,T,2,0,"ng-template",17),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb()),2&t&&(c.Cb(12),c.kc("formGroup",e.form),c.Cb(8),c.kc("disabled",e.loading),c.Cb(1),c.kc("ngClass",c.oc(10,C,!e.loading,e.loading)),c.Cb(9),c.kc("columns",e.cols)("value",e.metasSaving)("paginator",!0)("rows",10)("responsive",!0)("lazy",!0)("totalRecords",e.totalRecords))},directives:[o.o,o.i,o.e,o.a,o.h,o.d,l.i,f.d,u.e,l.j,f.c,l.k,f.b,f.a,v.a],styles:[".customer-badge[_ngcontent-%COMP%]{border-radius:2px;padding:.25em .5em;text-transform:uppercase;font-weight:700;font-size:12px;letter-spacing:.3px}.customer-badge.status-qualified[_ngcontent-%COMP%]{background-color:#c8e6c9;color:#256029}.customer-badge.status-unqualified[_ngcontent-%COMP%]{background-color:#ffcdd2;color:#c63737}"]}),U),w=function t(){_classCallCheck(this,t)},O=n("Gxio"),x=n("kAuD");function P(t,e){1&t&&(c.Ub(0,"div",1),c.Pb(1,"img",9),c.Tb())}function F(t,e){1&t&&(c.Ub(0,"div"),c.Hc(1," El a\xf1o es obligatorio "),c.Tb())}function H(t,e){1&t&&(c.Ub(0,"div"),c.Hc(1," El a\xf1o debe estar formado por cuatro n\xfameros "),c.Tb())}function I(t,e){if(1&t&&(c.Ub(0,"div",24),c.Fc(1,F,2,0,"div",25),c.Fc(2,H,2,0,"div",25),c.Tb()),2&t){var n=c.ec(2);c.Cb(1),c.kc("ngIf",n.form.controls.anno.errors.required),c.Cb(1),c.kc("ngIf",n.form.controls.anno.errors.pattern)}}function _(t,e){1&t&&(c.Ub(0,"div"),c.Hc(1," La cantidad es obligatoria "),c.Tb())}function R(t,e){1&t&&(c.Ub(0,"div"),c.Hc(1," La cantidad no puede ser superior a 100000 "),c.Tb())}function j(t,e){if(1&t&&(c.Ub(0,"div",24),c.Fc(1,_,2,0,"div",25),c.Fc(2,R,2,0,"div",25),c.Tb()),2&t){var n=c.ec(2);c.Cb(1),c.kc("ngIf",n.form.controls.cantidad.errors.required),c.Cb(1),c.kc("ngIf",n.form.controls.cantidad.errors.max)}}var E=function(t,e){return{"fa-save":t,"fa-spinner fa-spin":e}};function A(t,e){if(1&t){var n=c.Vb();c.Ub(0,"div",10),c.Ub(1,"div",11),c.Hc(2," Dise\xf1ador objetivo "),c.Tb(),c.Ub(3,"div",12),c.Ub(4,"div",1),c.Ub(5,"div",2),c.Ub(6,"form",13),c.Ub(7,"div",1),c.Ub(8,"div",14),c.Ub(9,"label",15),c.Hc(10,"A\xf1o"),c.Tb(),c.Pb(11,"input",16),c.Fc(12,I,3,2,"div",17),c.Tb(),c.Ub(13,"div",14),c.Ub(14,"label",18),c.Hc(15,"Cantidad"),c.Tb(),c.Pb(16,"input",19),c.Fc(17,j,3,2,"div",17),c.Tb(),c.Tb(),c.Ub(18,"div",20),c.Ub(19,"div",21),c.Ub(20,"button",22),c.cc("click",(function(){return c.xc(n),c.ec().save()})),c.Ub(21,"span"),c.Pb(22,"i",23),c.Hc(23," Guardar "),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb()}if(2&t){var i=c.ec();c.Cb(6),c.kc("formGroup",i.form),c.Cb(6),c.kc("ngIf",i.form.controls.anno.invalid&&(i.form.controls.anno.dirty||i.form.controls.anno.touched)),c.Cb(5),c.kc("ngIf",i.form.controls.cantidad.invalid&&(i.form.controls.cantidad.dirty||i.form.controls.cantidad.touched)),c.Cb(3),c.kc("disabled",i.form.pristine||i.form.invalid||i.loading),c.Cb(2),c.kc("ngClass",c.oc(5,E,!i.loading,i.loading))}}var L,q,B=function(){return{marginTop:"80px"}},M=[{path:"",component:S},{path:":id",component:(L=function(){function t(e,n,i,a,r){_classCallCheck(this,t),this.formBuilder=e,this.metasavingService=n,this.activatedRoute=i,this.location=a,this.messageService=r,this.annoRegex=/^(\d{4})$/}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this.newMetaSaving="new"===this.activatedRoute.snapshot.params.id,this.newMetaSaving?(this.metaSaving=new w,this.buildForm()):(Promise.resolve().then((function(){return t.loading=!0})),this.metasavingService.find(this.activatedRoute.snapshot.params.id).subscribe((function(e){t.metaSaving=e.data,t.loading=!1,t.buildForm()}),(function(e){t.loading=!1,t.messageService.add({severity:"error",summary:"Error",detail:e.error.message})})))}},{key:"buildForm",value:function(){this.form=this.formBuilder.group({anno:new o.c(this.metaSaving.anno,[o.n.required,o.n.pattern(this.annoRegex)]),cantidad:new o.c(this.metaSaving.cantidad,[o.n.required,o.n.max(1e5)])})}},{key:"save",value:function(){var t=this;if(Promise.resolve().then((function(){return t.loading=!0})),this.metaSaving.id){var e=Object.assign(this.metaSaving,this.form.value);this.metasavingService.update(e,this.metaSaving.id).subscribe((function(e){t.loading=!1,t.back()}),(function(e){t.loading=!1,t.messageService.add({severity:"error",summary:"Error",detail:e.error.message})}))}else{var n=Object.assign({},this.form.value);this.metasavingService.add(n).subscribe((function(e){t.loading=!1,t.back()}),(function(e){t.loading=!1,t.messageService.add({severity:"error",summary:"Error",detail:e.error.message})}))}}},{key:"back",value:function(){this.location.back()}}]),t}(),L.\u0275fac=function(t){return new(t||L)(c.Ob(o.b),c.Ob(b),c.Ob(r.a),c.Ob(l.g),c.Ob(u.d))},L.\u0275cmp=c.Ib({type:L,selectors:[["app-meta-saving-detail"]],decls:15,vars:5,consts:[[1,"wrapper"],[1,"row"],[1,"col-12"],["class","row",4,"ngIf"],["class","card",4,"ngIf"],[1,"row","mt-3"],[1,"col-12","text-right"],["type","button",1,"btn","btn-secondary","mr-1",3,"click"],["aria-hidden","true",1,"fas","fa-arrow-left"],["src","./assets/notfound.png","alt","No existen resultados",1,"d-block","mx-auto","img-not-found"],[1,"card"],[1,"card-header","bg-primary","text-white"],[1,"card-body"],[3,"formGroup"],[1,"col-12","col-md-6","form-group"],["for","anno"],["type","number","id","anno","formControlName","anno",1,"form-control","form-control-user"],["class","alert alert-danger mt-1",4,"ngIf"],["for","cantidad"],["type","textbox","formControlName","cantidad","placeholder","XX.XX","appTwoDigitDecimaNumber","",1,"form-control","form-control-user"],[1,"row","mt-1"],[1,"col-12","text-right","mt-2"],["type","button",1,"btn","btn-primary","mr-1",3,"disabled","click"],["aria-hidden","true",1,"fas",3,"ngClass"],[1,"alert","alert-danger","mt-1"],[4,"ngIf"]],template:function(t,e){1&t&&(c.Ub(0,"div",0),c.Ub(1,"div",1),c.Ub(2,"div",2),c.Ub(3,"h1"),c.Hc(4,"Detalle meta de ahorro"),c.Tb(),c.Tb(),c.Tb(),c.Pb(5,"hr"),c.Fc(6,P,2,0,"div",3),c.Fc(7,A,24,8,"div",4),c.Ub(8,"div",5),c.Ub(9,"div",6),c.Ub(10,"button",7),c.cc("click",(function(){return e.back()})),c.Ub(11,"span"),c.Pb(12,"i",8),c.Hc(13," Volver"),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Pb(14,"p-toast")),2&t&&(c.Cb(6),c.kc("ngIf",!e.metaSaving&&!e.loading),c.Cb(1),c.kc("ngIf",e.metaSaving),c.Cb(7),c.Dc(c.mc(4,B)))},directives:[l.k,O.a,o.o,o.i,o.e,o.k,o.a,o.h,o.d,x.a,l.i],styles:[""]}),L)}],N=((q=function t(){_classCallCheck(this,t)}).\u0275mod=c.Mb({type:q}),q.\u0275inj=c.Lb({factory:function(t){return new(t||q)},imports:[[r.e.forChild(M)],r.e]}),q);n.d(e,"MetaSavingModule",(function(){return z}));var D,z=((D=function t(){_classCallCheck(this,t)}).\u0275mod=c.Mb({type:D}),D.\u0275inj=c.Lb({factory:function(t){return new(t||D)},imports:[[a.a,N]]}),D)}}]);