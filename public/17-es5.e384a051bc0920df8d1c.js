function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(s){o=!0,i=s}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{XWaT:function(e,t,n){"use strict";n.r(t);var r=n("PCNd"),o=n("I5S5"),i=n("tyNb"),a=n("3Pt+"),c=function e(){_classCallCheck(this,e)},s=n("fXoL"),l=n("0MV2"),d=n("7zfz"),b=n("qan5"),u=n("LuMj"),m=n("ofXK"),p=n("arFO");function f(e,t){1&e&&(s.Tb(0,"div"),s.Gc(1," El a\xf1o es obligatorio "),s.Sb())}function v(e,t){1&e&&(s.Tb(0,"div"),s.Gc(1," El a\xf1o debe estar formado por cuatro n\xfameros "),s.Sb())}function g(e,t){if(1&e&&(s.Tb(0,"div",24),s.Ec(1,f,2,0,"div",25),s.Ec(2,v,2,0,"div",25),s.Sb()),2&e){var n=s.dc(2);s.Bb(1),s.jc("ngIf",n.addForm.controls.anno.errors.required),s.Bb(1),s.jc("ngIf",n.addForm.controls.anno.errors.pattern)}}function h(e,t){1&e&&(s.Tb(0,"div"),s.Gc(1," El mes es obligatorio "),s.Sb())}function S(e,t){if(1&e&&(s.Tb(0,"div",24),s.Ec(1,h,2,0,"div",25),s.Sb()),2&e){var n=s.dc(2);s.Bb(1),s.jc("ngIf",n.addForm.controls.mes.errors.required)}}var T=function(e,t){return{"fa-plus":e,"fa-spinner fa-spin":t}};function y(e,t){if(1&e){var n=s.Ub();s.Tb(0,"form",14),s.Tb(1,"div",3),s.Tb(2,"div",15),s.Tb(3,"label",16),s.Gc(4,"A\xf1o"),s.Sb(),s.Ob(5,"input",17),s.Ec(6,g,3,2,"div",18),s.Sb(),s.Tb(7,"div",15),s.Tb(8,"label",19),s.Gc(9,"Mes"),s.Sb(),s.Ob(10,"p-dropdown",20),s.Ec(11,S,2,1,"div",18),s.Sb(),s.Tb(12,"div",21),s.Tb(13,"button",22),s.bc("click",(function(){return s.wc(n),s.dc().addTemplate()})),s.Ob(14,"i",23),s.Tb(15,"span"),s.Gc(16," A\xf1adir"),s.Sb(),s.Sb(),s.Sb(),s.Sb(),s.Sb()}if(2&e){var r=s.dc();s.jc("formGroup",r.addForm),s.Bb(6),s.jc("ngIf",r.addForm.controls.anno.invalid&&(r.addForm.controls.anno.dirty||r.addForm.controls.anno.touched)),s.Bb(4),s.jc("options",r.months)("showClear",!0),s.Bb(1),s.jc("ngIf",r.addForm.controls.mes.invalid&&(r.addForm.controls.mes.dirty||r.addForm.controls.mes.touched)),s.Bb(2),s.jc("disabled",r.addForm.pristine||r.addForm.invalid||r.loading),s.Bb(1),s.jc("ngClass",s.nc(7,T,!r.loading,r.loading))}}function w(e,t){1&e&&(s.Tb(0,"div"),s.Gc(1," El a\xf1o es obligatorio "),s.Sb())}function E(e,t){1&e&&(s.Tb(0,"div"),s.Gc(1," El a\xf1o debe estar formado por cuatro n\xfameros "),s.Sb())}function k(e,t){if(1&e&&(s.Tb(0,"div",24),s.Ec(1,w,2,0,"div",25),s.Ec(2,E,2,0,"div",25),s.Sb()),2&e){var n=s.dc(2);s.Bb(1),s.jc("ngIf",n.cloneForm.controls.anno.errors.required),s.Bb(1),s.jc("ngIf",n.cloneForm.controls.anno.errors.pattern)}}function x(e,t){1&e&&(s.Tb(0,"div"),s.Gc(1," El mes es obligatorio "),s.Sb())}function j(e,t){if(1&e&&(s.Tb(0,"div",24),s.Ec(1,x,2,0,"div",25),s.Sb()),2&e){var n=s.dc(2);s.Bb(1),s.jc("ngIf",n.cloneForm.controls.mes.errors.required)}}function M(e,t){1&e&&(s.Tb(0,"div"),s.Gc(1," El a\xf1o es obligatorio "),s.Sb())}function I(e,t){if(1&e&&(s.Tb(0,"div",24),s.Ec(1,M,2,0,"div",25),s.Sb()),2&e){var n=s.dc(2);s.Bb(1),s.jc("ngIf",n.cloneForm.controls.newAnno.errors.required)}}function B(e,t){1&e&&(s.Tb(0,"div"),s.Gc(1," El mes es obligatorio "),s.Sb())}function C(e,t){if(1&e&&(s.Tb(0,"div",24),s.Ec(1,B,2,0,"div",25),s.Sb()),2&e){var n=s.dc(2);s.Bb(1),s.jc("ngIf",n.cloneForm.controls.newMes.errors.required)}}var G=function(e,t){return{"fa-edit":e,"fa-spinner fa-spin":t}};function F(e,t){if(1&e){var n=s.Ub();s.Tb(0,"form",14),s.Tb(1,"div",3),s.Tb(2,"div",15),s.Tb(3,"label",16),s.Gc(4,"A\xf1o"),s.Sb(),s.Ob(5,"input",17),s.Ec(6,k,3,2,"div",18),s.Sb(),s.Tb(7,"div",15),s.Tb(8,"label",19),s.Gc(9,"Mes"),s.Sb(),s.Ob(10,"p-dropdown",20),s.Ec(11,j,2,1,"div",18),s.Sb(),s.Sb(),s.Tb(12,"div",3),s.Tb(13,"div",15),s.Tb(14,"label",16),s.Gc(15,"Nuevo a\xf1o"),s.Sb(),s.Ob(16,"input",26),s.Ec(17,I,2,1,"div",18),s.Sb(),s.Tb(18,"div",15),s.Tb(19,"label",19),s.Gc(20,"Nuevo mes"),s.Sb(),s.Ob(21,"p-dropdown",27),s.Ec(22,C,2,1,"div",18),s.Sb(),s.Tb(23,"div",21),s.Tb(24,"button",28),s.bc("click",(function(){return s.wc(n),s.dc().clone()})),s.Ob(25,"i",23),s.Tb(26,"span"),s.Gc(27," Copiar"),s.Sb(),s.Sb(),s.Sb(),s.Sb(),s.Sb()}if(2&e){var r=s.dc();s.jc("formGroup",r.cloneForm),s.Bb(6),s.jc("ngIf",r.cloneForm.controls.anno.invalid&&(r.cloneForm.controls.anno.dirty||r.cloneForm.controls.anno.touched)),s.Bb(4),s.jc("options",r.months)("showClear",!0),s.Bb(1),s.jc("ngIf",r.cloneForm.controls.mes.invalid&&(r.cloneForm.controls.mes.dirty||r.cloneForm.controls.mes.touched)),s.Bb(6),s.jc("ngIf",r.cloneForm.controls.newAnno.invalid&&(r.cloneForm.controls.newAnno.dirty||r.cloneForm.controls.newAnno.touched)),s.Bb(4),s.jc("options",r.months)("showClear",!0),s.Bb(1),s.jc("ngIf",r.cloneForm.controls.newMes.invalid&&(r.cloneForm.controls.newMes.dirty||r.cloneForm.controls.newMes.touched)),s.Bb(2),s.jc("disabled",r.cloneForm.pristine||r.cloneForm.invalid||r.loading),s.Bb(1),s.jc("ngClass",s.nc(11,G,!r.loading,r.loading))}}function P(e,t){if(1&e){var n=s.Ub();s.Tb(0,"div",33),s.Tb(1,"div",34),s.Tb(2,"div",6),s.Tb(3,"div",1),s.Tb(4,"div",2),s.Gc(5),s.Sb(),s.Tb(6,"div",35),s.Tb(7,"button",36),s.bc("click",(function(){s.wc(n);var e=t.$implicit;return s.dc(2).editTemplate(e.id)})),s.Ob(8,"i",37),s.Sb(),s.Tb(9,"button",38),s.bc("click",(function(){s.wc(n);var e=t.$implicit;return s.dc(2).confirm(e.id)})),s.Ob(10,"i",39),s.Sb(),s.Sb(),s.Sb(),s.Sb(),s.Sb(),s.Sb()}if(2&e){var r=t.$implicit,o=s.dc(2);s.Bb(5),s.Ic(" ",o.getMonth(r.mes)," ")}}function _(e,t){if(1&e){var n=s.Ub();s.Tb(0,"div"),s.Tb(1,"div",3),s.Tb(2,"div",29),s.Tb(3,"label",30),s.Gc(4,"Seleccione un a\xf1o:"),s.Sb(),s.Tb(5,"p-dropdown",31),s.bc("ngModelChange",(function(e){return s.wc(n),s.dc().selectedYear=e}))("onChange",(function(e){return s.wc(n),s.dc().selectYear(e)})),s.Sb(),s.Sb(),s.Sb(),s.Tb(6,"div",3),s.Ec(7,P,11,1,"div",32),s.Sb(),s.Sb()}if(2&e){var r=s.dc();s.Bb(5),s.jc("ngModel",r.selectedYear)("options",r.years),s.Bb(2),s.jc("ngForOf",r.templates)}}function O(e,t){1&e&&(s.Tb(0,"div",1),s.Tb(1,"div",41),s.Ob(2,"img",42),s.Sb(),s.Sb())}function A(e,t){if(1&e&&s.Ec(0,O,3,0,"div",40),2&e){var n=s.dc();s.jc("ngIf",!n.loading)}}var N,R=((N=function(){function e(t,n,r,o,i,a){_classCallCheck(this,e),this.router=t,this.templateService=n,this.formBuilder=r,this.messageService=o,this.confirmationService=i,this.monthService=a,this.annoRegex=/^(\d{4})$/,this.optionCreation="A\xf1adir plantilla",this.months=this.monthService.getMonths()}return _createClass(e,[{key:"ngOnInit",value:function(){this.getTemplates(),this.buildForm()}},{key:"buildForm",value:function(){this.addForm=this.formBuilder.group({anno:new a.c("",[a.n.required,a.n.pattern(this.annoRegex)]),mes:new a.c("",a.n.required)}),this.cloneForm=this.formBuilder.group({anno:new a.c("",[a.n.required,a.n.pattern(this.annoRegex)]),mes:new a.c("",a.n.required),newAnno:new a.c("",[a.n.required,a.n.pattern(this.annoRegex)]),newMes:new a.c("",a.n.required)})}},{key:"getTemplates",value:function(){var e=this;Promise.resolve().then((function(){return e.loading=!0})),this.templateService.get().subscribe((function(t){e.templatesTotal=t.data,e.years=t.years,e.loading=!1,e.years&&e.years.length>0&&e.calculateTemplates(e.years[0])}),(function(){e.loading=!1}))}},{key:"getMonth",value:function(e){return this.monthService.getMonths().find((function(t){return t.value===e})).name}},{key:"selectYear",value:function(e){this.calculateTemplates()}},{key:"editTemplate",value:function(e){this.router.navigate(["/home/templates/"+e])}},{key:"addTemplate",value:function(){var e=this,t=new c;t.anno=this.addForm.get("anno").value,t.mes=this.addForm.get("mes").value.value,Promise.resolve().then((function(){return e.loading=!0})),this.templateService.add(t).subscribe((function(t){var n=_toConsumableArray(e.templatesTotal);n.push(t.data),e.templatesTotal=n,e.years=t.years,e.years&&e.years.length>0&&e.calculateTemplates(e.years[0]),e.loading=!1,e.messageService.add({severity:"success",summary:"\xc9xito",detail:t.message})}),(function(t){e.loading=!1,e.messageService.add({severity:"error",summary:"Error",detail:t.error.message})}))}},{key:"clone",value:function(){var e=this;Promise.resolve().then((function(){return e.loading=!0}));var t={anno:this.cloneForm.get("anno").value,mes:this.cloneForm.get("mes").value.value,newAnno:this.cloneForm.get("newAnno").value,newMes:this.cloneForm.get("newMes").value.value};this.templateService.clone(t).subscribe((function(t){var n=_toConsumableArray(e.templatesTotal);n.push(t.data),e.templatesTotal=n,e.years=t.years,e.calculateTemplates(),e.loading=!1,e.messageService.add({severity:"success",summary:"\xc9xito",detail:t.message})}),(function(t){e.loading=!1,e.messageService.add({severity:"error",summary:"Error",detail:t.error.message})}))}},{key:"calculateTemplates",value:function(e){var t=this;this.selectedYear=e||this.selectedYear,this.templates=this.templatesTotal.filter((function(e){return e.anno===t.selectedYear.anno})).sort((function(e,t){return e.mes>t.mes?1:-1}))}},{key:"confirm",value:function(e){var t=this;this.confirmationService.confirm({message:"\xbfEst\xe1s seguro de que deseas borrar?",header:"Confirmaci\xf3n",icon:"pi pi-exclamation-triangle",accept:function(){t.delete(e)}})}},{key:"delete",value:function(e){var t=this;this.templateService.delete(e).subscribe((function(n){t.templatesTotal=t.templatesTotal.filter((function(t){return t.id!==e})),t.templates=t.templates.filter((function(t){return t.id!==e})),t.messageService.add({severity:"error",summary:"Error",detail:n.message}),t.years=n.years,t.years&&t.years.length>0&&t.calculateTemplates(t.years[0])}))}}]),e}()).\u0275fac=function(e){return new(e||N)(s.Nb(i.b),s.Nb(l.a),s.Nb(a.b),s.Nb(d.d),s.Nb(d.a),s.Nb(b.a))},N.\u0275cmp=s.Hb({type:N,selectors:[["app-templates"]],decls:30,vars:6,consts:[[1,"wrapper"],[1,"row"],[1,"col-12"],[1,"row","mt-3"],[1,"card"],[1,"card-header","bg-primary","text-white"],[1,"card-body"],[1,"ui-g",2,"width","250px","margin-bottom","10px"],[1,"ui-g-12"],["name","group1","value","A\xf1adir plantilla","label","A\xf1adir plantilla","inputId","opt1",3,"ngModel","ngModelChange"],["name","group1","value","Copiar plantilla","label","Copiar plantilla","inputId","opt2",3,"ngModel","ngModelChange"],[3,"formGroup",4,"ngIf"],[4,"ngIf","ngIfElse"],["noTemplates",""],[3,"formGroup"],[1,"col-12","col-md-4","form-group"],["for","anno"],["type","number","id","anno","formControlName","anno",1,"form-control","form-control-user"],["class","alert alert-danger mt-1",4,"ngIf"],["for","mes"],["formControlName","mes","placeholder","Seleccione un mes","optionLabel","name",3,"options","showClear"],[1,"col-12","col-md-4","form-group","text-right","d-flex","align-items-end"],["type","button",1,"btn","btn-primary","mr-4",3,"disabled","click"],["aria-hidden","true",1,"fas",3,"ngClass"],[1,"alert","alert-danger","mt-1"],[4,"ngIf"],["type","number","id","anno","formControlName","newAnno",1,"form-control","form-control-user"],["formControlName","newMes","placeholder","Seleccione un mes","optionLabel","name",3,"options","showClear"],["type","button",1,"btn","btn-primary",3,"disabled","click"],[1,"col-12","col-md-3","form-group"],["for","exampleInputEmail1"],["optionLabel","anno","placeholder","Seleccione un a\xf1o",3,"ngModel","options","ngModelChange","onChange"],["class","col-12 col-md-4 col-xl-3 mt-3",4,"ngFor","ngForOf"],[1,"col-12","col-md-4","col-xl-3","mt-3"],[1,"card","bg-secondary","border","border-dark"],[1,"col-12","text-right"],["type","button",1,"btn","btn-primary",3,"click"],["aria-hidden","true",1,"fas","fa-edit"],["type","button",1,"ml-1","btn","btn-primary",3,"click"],["aria-hidden","true",1,"fas","fa-trash"],["class","row",4,"ngIf"],[1,"col-4","offset-4","form-group"],["src","assets/notfound.png","alt","No existen resultados",1,"d-block","mx-auto","img-not-found"]],template:function(e,t){if(1&e&&(s.Tb(0,"div",0),s.Tb(1,"div",1),s.Tb(2,"div",2),s.Tb(3,"h1"),s.Gc(4,"Plantillas"),s.Sb(),s.Sb(),s.Sb(),s.Ob(5,"hr"),s.Tb(6,"div",3),s.Tb(7,"div",2),s.Tb(8,"div",4),s.Tb(9,"div",5),s.Gc(10," Creador de plantillas "),s.Sb(),s.Tb(11,"div",6),s.Tb(12,"div",1),s.Tb(13,"div",2),s.Tb(14,"div",7),s.Tb(15,"div",8),s.Tb(16,"p-radioButton",9),s.bc("ngModelChange",(function(e){return t.optionCreation=e})),s.Sb(),s.Sb(),s.Tb(17,"div",8),s.Tb(18,"p-radioButton",10),s.bc("ngModelChange",(function(e){return t.optionCreation=e})),s.Sb(),s.Sb(),s.Sb(),s.Sb(),s.Sb(),s.Ec(19,y,17,10,"form",11),s.Ec(20,F,28,14,"form",11),s.Sb(),s.Sb(),s.Sb(),s.Sb(),s.Tb(21,"div",3),s.Tb(22,"div",2),s.Tb(23,"div",4),s.Tb(24,"div",5),s.Gc(25," Listado de plantillas "),s.Sb(),s.Tb(26,"div",6),s.Ec(27,_,8,3,"div",12),s.Ec(28,A,1,1,"ng-template",null,13,s.Fc),s.Sb(),s.Sb(),s.Sb(),s.Sb(),s.Sb()),2&e){var n=s.uc(29);s.Bb(16),s.jc("ngModel",t.optionCreation),s.Bb(2),s.jc("ngModel",t.optionCreation),s.Bb(1),s.jc("ngIf","A\xf1adir plantilla"===t.optionCreation),s.Bb(1),s.jc("ngIf","Copiar plantilla"===t.optionCreation),s.Bb(7),s.jc("ngIf",(null==t.templatesTotal?null:t.templatesTotal.length)>0)("ngIfElse",n)}},directives:[u.a,a.h,a.j,m.k,a.o,a.i,a.e,a.k,a.a,a.d,p.a,m.i,m.j],styles:[""]}),N),$=n("QVck"),q=n("mgSE"),L=n("itXk"),U=n("PTGG"),X=n("OS4P"),H=n("3iQZ"),Y=n("kAuD"),D=n("Ji6n"),W=n("xlun");function z(e,t){if(1&e&&(s.Tb(0,"h1"),s.Gc(1),s.Sb()),2&e){var n=s.dc();s.Bb(1),s.Jc("Plantilla ",n.getMonth(n.template.mes)," ",n.template.anno,"")}}function J(e,t){1&e&&(s.Tb(0,"h1"),s.Gc(1,"Plantilla"),s.Sb())}function V(e,t){1&e&&(s.Tb(0,"div",1),s.Ob(1,"img",11),s.Sb())}var K=function(){return["/home/expenses/new"]};function Q(e,t){1&e&&(s.Tb(0,"div",24),s.Gc(1," Si desea a\xf1adir un nuevo gasto acceda "),s.Tb(2,"a",25),s.Gc(3,"aqu\xed"),s.Sb(),s.Sb()),2&e&&(s.Bb(2),s.jc("routerLink",s.lc(1,K)))}var Z=function(){return["/home/profits/new"]};function ee(e,t){1&e&&(s.Tb(0,"div",24),s.Gc(1," Si desea a\xf1adir una nueva ganancia acceda "),s.Tb(2,"a",25),s.Gc(3,"aqu\xed"),s.Sb(),s.Sb()),2&e&&(s.Bb(2),s.jc("routerLink",s.lc(1,Z)))}function te(e,t){if(1&e){var n=s.Ub();s.Tb(0,"div",12),s.Tb(1,"div",13),s.Gc(2," Gestor de recursos "),s.Sb(),s.Tb(3,"div",14),s.Tb(4,"div",15),s.Tb(5,"div",16),s.Tb(6,"label",17),s.Gc(7,"Tipo de recurso"),s.Sb(),s.Tb(8,"p-dropdown",18),s.bc("onChange",(function(e){return s.wc(n),s.dc().selectResource(e)})),s.Sb(),s.Sb(),s.Tb(9,"div",16),s.Tb(10,"label",17),s.Gc(11,"Recurso"),s.Sb(),s.Tb(12,"p-dropdown",19),s.bc("ngModelChange",(function(e){return s.wc(n),s.dc().selectedResource=e})),s.Sb(),s.Sb(),s.Ec(13,Q,4,2,"div",20),s.Ec(14,ee,4,2,"div",20),s.Sb(),s.Tb(15,"div",1),s.Tb(16,"div",21),s.Tb(17,"button",22),s.bc("click",(function(){return s.wc(n),s.dc().addResouce()})),s.Ob(18,"i",23),s.Tb(19,"span"),s.Gc(20," A\xf1adir recurso"),s.Sb(),s.Sb(),s.Sb(),s.Sb(),s.Sb(),s.Sb()}if(2&e){var r=s.dc();s.Bb(8),s.jc("options",r.types),s.Bb(4),s.jc("options",r.resources)("ngModel",r.selectedResource),s.Bb(1),s.jc("ngIf",!r.isProfit),s.Bb(1),s.jc("ngIf",r.isProfit),s.Bb(3),s.jc("disabled",!r.selectedResource||""===r.selectedResource)}}function ne(e,t){if(1&e){var n=s.Ub();s.Tb(0,"div",37),s.Tb(1,"div",38),s.Gc(2),s.Sb(),s.Tb(3,"div",39),s.Tb(4,"input",40),s.bc("input",(function(){return s.wc(n),s.dc(2).calculate()}))("ngModelChange",(function(e){return s.wc(n),t.$implicit.cantidad=e})),s.Sb(),s.Sb(),s.Tb(5,"div",41),s.Tb(6,"button",42),s.bc("click",(function(){s.wc(n);var e=t.$implicit;return s.dc(2).deleteRevenue(e.id)})),s.Ob(7,"i",43),s.Sb(),s.Sb(),s.Sb()}if(2&e){var r=t.$implicit;s.Bb(2),s.Ic(" ",r.ganancia_id.nombre," "),s.Bb(2),s.jc("ngModel",r.cantidad)}}function re(e,t){if(1&e){var n=s.Ub();s.Tb(0,"div",37),s.Tb(1,"div",38),s.Gc(2),s.Sb(),s.Tb(3,"div",39),s.Tb(4,"input",40),s.bc("input",(function(){return s.wc(n),s.dc(3).calculate()}))("ngModelChange",(function(e){return s.wc(n),s.dc().$implicit.cantidad=e})),s.Sb(),s.Sb(),s.Tb(5,"div",45),s.Tb(6,"p-checkbox",46),s.bc("ngModelChange",(function(e){return s.wc(n),s.dc().$implicit.pagado=e})),s.Sb(),s.Sb(),s.Tb(7,"div",47),s.Tb(8,"button",42),s.bc("click",(function(){s.wc(n);var e=s.dc().$implicit;return s.dc(2).deletePayment(e.id)})),s.Ob(9,"i",43),s.Sb(),s.Sb(),s.Sb()}if(2&e){var r=s.dc().$implicit;s.Bb(2),s.Ic(" ",r.gasto_id.nombre," "),s.Bb(2),s.jc("ngModel",r.cantidad),s.Bb(2),s.jc("ngModel",r.pagado)}}function oe(e,t){if(1&e&&(s.Tb(0,"div"),s.Ec(1,re,10,3,"div",44),s.Sb()),2&e){var n=t.$implicit;s.Bb(1),s.jc("ngIf","Mensuales Primarios"===n.gasto_id.id_tipo_gasto.valor)}}function ie(e,t){if(1&e){var n=s.Ub();s.Tb(0,"div",37),s.Tb(1,"div",38),s.Gc(2),s.Sb(),s.Tb(3,"div",39),s.Tb(4,"input",40),s.bc("input",(function(){return s.wc(n),s.dc(3).calculate()}))("ngModelChange",(function(e){return s.wc(n),s.dc().$implicit.cantidad=e})),s.Sb(),s.Sb(),s.Tb(5,"div",45),s.Tb(6,"p-checkbox",46),s.bc("ngModelChange",(function(e){return s.wc(n),s.dc().$implicit.pagado=e})),s.Sb(),s.Sb(),s.Tb(7,"div",48),s.Tb(8,"button",42),s.bc("click",(function(){s.wc(n);var e=s.dc().$implicit;return s.dc(2).deletePayment(e.id)})),s.Ob(9,"i",43),s.Sb(),s.Sb(),s.Sb()}if(2&e){var r=s.dc().$implicit;s.Bb(2),s.Ic(" ",r.gasto_id.nombre," "),s.Bb(2),s.jc("ngModel",r.cantidad),s.Bb(2),s.jc("ngModel",r.pagado)}}function ae(e,t){if(1&e&&(s.Tb(0,"div"),s.Ec(1,ie,10,3,"div",44),s.Sb()),2&e){var n=t.$implicit;s.Bb(1),s.jc("ngIf","Mensuales Secundarios"===n.gasto_id.id_tipo_gasto.valor)}}function ce(e,t){if(1&e){var n=s.Ub();s.Tb(0,"div",26),s.Tb(1,"div",13),s.Gc(2," Plantilla "),s.Sb(),s.Tb(3,"div",14),s.Tb(4,"div",27),s.Tb(5,"div",28),s.Gc(6," Nombre "),s.Sb(),s.Tb(7,"div",29),s.Gc(8," Valor "),s.Sb(),s.Tb(9,"div",29),s.Gc(10," Opciones "),s.Sb(),s.Sb(),s.Tb(11,"div",30),s.Tb(12,"div",31),s.Gc(13," Ingresos "),s.Sb(),s.Tb(14,"div",32),s.Gc(15),s.Sb(),s.Ob(16,"div",33),s.Sb(),s.Ec(17,ne,8,2,"div",34),s.Tb(18,"div",30),s.Tb(19,"div",31),s.Gc(20," Disponible Gastos primarios "),s.Sb(),s.Tb(21,"div",32),s.Gc(22),s.Sb(),s.Ob(23,"div",33),s.Sb(),s.Ec(24,oe,2,1,"div",35),s.Tb(25,"div",30),s.Tb(26,"div",31),s.Gc(27," Disponible Gastos secundarios "),s.Sb(),s.Tb(28,"div",32),s.Gc(29),s.Sb(),s.Ob(30,"div",33),s.Sb(),s.Ec(31,ae,2,1,"div",35),s.Tb(32,"div",30),s.Tb(33,"div",31),s.Gc(34," Ahorros esperados "),s.Sb(),s.Tb(35,"div",32),s.Gc(36),s.Sb(),s.Ob(37,"div",33),s.Sb(),s.Tb(38,"div",30),s.Tb(39,"div",31),s.Gc(40," Ahorros reales "),s.Sb(),s.Tb(41,"div",32),s.Gc(42),s.Sb(),s.Ob(43,"div",33),s.Sb(),s.Tb(44,"div",8),s.Tb(45,"div",2),s.Tb(46,"button",9),s.bc("click",(function(){return s.wc(n),s.dc().save()})),s.Ob(47,"i",36),s.Tb(48,"span"),s.Gc(49," Guardar"),s.Sb(),s.Sb(),s.Sb(),s.Sb(),s.Sb(),s.Sb()}if(2&e){var r=s.dc();s.Bb(15),s.Ic(" ",r.revenues," "),s.Bb(2),s.jc("ngForOf",r.template.ingresos),s.Bb(5),s.Ic(" ",r.primaryExpenses," "),s.Bb(2),s.jc("ngForOf",r.template.pagos),s.Bb(5),s.Ic(" ",r.secondaryExpenses," "),s.Bb(2),s.jc("ngForOf",r.template.pagos),s.Bb(5),s.Ic(" ",r.promiseSavings," "),s.Bb(6),s.Ic(" ",r.realSavings," ")}}var se=function(e,t){return{"alert-success":e,"alert-danger":t}};function le(e,t){if(1&e&&(s.Tb(0,"div",54),s.Gc(1),s.Sb()),2&e){var n=t.$implicit;s.jc("ngClass",s.nc(2,se,n.status,!n.status)),s.Bb(1),s.Ic(" ",n.message," ")}}function de(e,t){if(1&e&&(s.Tb(0,"div"),s.Ec(1,le,2,5,"div",53),s.Sb()),2&e){var n=s.dc(2);s.Bb(1),s.jc("ngForOf",n.tips)}}function be(e,t){1&e&&(s.Tb(0,"div",55),s.Gc(1," No existen tips que aportar "),s.Sb())}function ue(e,t){if(1&e&&(s.Tb(0,"div",54),s.Gc(1),s.Sb()),2&e){var n=t.$implicit;s.jc("ngClass",s.nc(2,se,n.status,!n.status)),s.Bb(1),s.Ic(" ",n.message," ")}}function me(e,t){if(1&e&&(s.Tb(0,"div"),s.Ec(1,ue,2,5,"div",53),s.Sb()),2&e){var n=s.dc(2);s.Bb(1),s.jc("ngForOf",n.goodPracticesUsed)}}function pe(e,t){1&e&&(s.Tb(0,"div",55),s.Gc(1," No existen buenas pr\xe1cticas que aplicar "),s.Sb())}function fe(e,t){if(1&e&&(s.Tb(0,"div",15),s.Tb(1,"div",49),s.Tb(2,"div",12),s.Tb(3,"div",13),s.Gc(4," Tips "),s.Sb(),s.Tb(5,"div",14),s.Ec(6,de,2,1,"div",50),s.Ec(7,be,2,0,"ng-template",null,51,s.Fc),s.Sb(),s.Sb(),s.Sb(),s.Tb(9,"div",49),s.Tb(10,"div",12),s.Tb(11,"div",13),s.Gc(12," Buenas pr\xe1cticas "),s.Sb(),s.Tb(13,"div",14),s.Ec(14,me,2,1,"div",50),s.Ec(15,pe,2,0,"ng-template",null,52,s.Fc),s.Sb(),s.Sb(),s.Sb(),s.Sb()),2&e){var n=s.uc(8),r=s.uc(16),o=s.dc();s.Bb(6),s.jc("ngIf",(null==o.tips?null:o.tips.length)>0)("ngIfElse",n),s.Bb(8),s.jc("ngIf",(null==o.goodPracticesUsed?null:o.goodPracticesUsed.length)>0)("ngIfElse",r)}}var ve,ge,he=[{path:"",component:R},{path:":id",component:(ve=function(){function e(t,n,r,o,i,a,c,s){_classCallCheck(this,e),this.activatedRoute=t,this.location=n,this.templateService=r,this.monthService=o,this.expenseService=i,this.profitService=a,this.messageService=c,this.goodPracticeService=s,this.isProfit=!0,this.revenues=0,this.primaryExpenses=0,this.secondaryExpenses=0,this.promiseSavings=0,this.realSavings=0,this.goodPractices=[],this.goodPracticesUsed=[],this.tips=[],this.types=[{name:"Ingresos",code:"ingresos"},{name:"Gastos primarios",code:"gastos-primarios"},{name:"Gastos secundarios",code:"gastos-secundarios"}]}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;Promise.resolve().then((function(){return e.loading=!0})),this.isNewTemplate="new"===this.activatedRoute.snapshot.params.id,Object(L.a)(this.getPrimaryMonthlyExpenses(),this.getSecondaryMonthlyExpenses(),this.getMonthlyProfits(),this.getGoodPractices(),this.getTemplate()).subscribe((function(t){var n=_slicedToArray(t,5),r=n[0],o=n[1],i=n[2],a=n[3],c=n[4];e.primaryMonthlyExpenses=r.data,e.secondaryMonthlyExpenses=o.data,e.monthlyProfits=i.data,e.resources=e.monthlyProfits,e.goodPractices=a.data,e.template=c.data,e.loading=!1,e.calculate()}),(function(t){e.loading=!1,e.messageService.add({severity:"error",summary:"Error",detail:t.error.message})}))}},{key:"getTemplate",value:function(){return this.templateService.find(this.activatedRoute.snapshot.params.id)}},{key:"getPrimaryMonthlyExpenses",value:function(){return this.expenseService.findAllPrimaryMonthlyExpenses()}},{key:"getSecondaryMonthlyExpenses",value:function(){return this.expenseService.findAllSecondaryMonthlyExpenses()}},{key:"getMonthlyProfits",value:function(){return this.profitService.findAllMonthlyProfits()}},{key:"getGoodPractices",value:function(){return this.goodPracticeService.findAll()}},{key:"selectResource",value:function(e){"ingresos"==e.value.code?(this.resources=this.monthlyProfits,this.isProfit=!0):"gastos-primarios"==e.value.code?(this.resources=this.primaryMonthlyExpenses,this.isProfit=!1):"gastos-secundarios"==e.value.code&&(this.resources=this.secondaryMonthlyExpenses,this.isProfit=!1),this.selectedResource=null}},{key:"back",value:function(){this.location.back()}},{key:"getMonth",value:function(e){return this.monthService.getMonth(e)}},{key:"addResouce",value:function(){var e=this;if(this.selectedResource.id_tipo_ganancia)if(this.template.ingresos.filter((function(t){return t.id===e.selectedResource.id})))this.messageService.add({severity:"error",summary:"Error",detail:"La ganancia ya est\xe1 a\xf1adida en la plantilla"});else{var t=new q.a;t.ganancia_id=this.selectedResource,t.cantidad=0,t.plantilla_id=this.template.id,t.id=this.selectedResource.id,this.template.ingresos.push(t)}else if(this.template.pagos.filter((function(t){return t.id===e.selectedResource.id})))this.messageService.add({severity:"error",summary:"Error",detail:"El gasto ya est\xe1 a\xf1adido en la plantilla"});else{var n=new $.a;n.gasto_id=this.selectedResource,n.cantidad=0,n.pagado=!1,n.plantilla_id=this.template.id,n.id=this.selectedResource.id,this.template.pagos.push(n)}}},{key:"deletePayment",value:function(e){this.template.pagos=this.template.pagos.filter((function(t){return t.id!==e})),this.calculate()}},{key:"deleteRevenue",value:function(e){this.template.ingresos=this.template.ingresos.filter((function(t){return t.id!==e})),this.calculate()}},{key:"save",value:function(){var e=this;if(0===this.template.pagos.length&&0===this.template.ingresos.length)this.messageService.add({severity:"error",summary:"Error",detail:"Se debe a\xf1adir al menos un gasto o ingreso"});else{var t=this.template.pagos.find((function(e){return null==e.cantidad||0===e.cantidad})),n=this.template.ingresos.find((function(e){return null==e.cantidad||0===e.cantidad}));t||n?this.messageService.add({severity:"error",summary:"Error",detail:"El campo valor no puede estar vac\xedo o ser 0"}):(this.template.pagos.forEach((function(e){return e.cantidad=+e.cantidad})),this.template.ingresos.forEach((function(e){return e.cantidad=+e.cantidad})),this.templateService.update(this.template).subscribe((function(t){e.messageService.add({severity:"success",summary:"\xc9xito",detail:"Se ha actualizado la plantilla"})}),(function(t){e.messageService.add({severity:"error",summary:"Error",detail:"No se ha podido actualizar la plantilla"})})))}}},{key:"calculate",value:function(){this.calculateTemplate(),this.calculateGoodPractices(),this.calculateTips()}},{key:"calculateTemplate",value:function(){this.revenues=this.template.ingresos.length>0?this.template.ingresos.map((function(e){return e.cantidad})).reduce((function(e,t){return e+t})):0;var e=this.template.pagos.filter((function(e){return"Mensuales Primarios"===e.gasto_id.id_tipo_gasto.valor})),t=0;e.length>0&&(t=e.map((function(e){return e.cantidad})).reduce((function(e,t){return e+t})));var n=this.template.pagos.filter((function(e){return"Mensuales Secundarios"===e.gasto_id.id_tipo_gasto.valor})),r=0;n.length>0&&(r=n.map((function(e){return e.cantidad})).reduce((function(e,t){return e+t}))),this.primaryExpenses=Math.round(.5*this.revenues*100)/100-t,this.secondaryExpenses=Math.round(.3*this.revenues*100)/100-r,this.promiseSavings=Math.round(.2*this.revenues*100)/100,this.realSavings=Math.round(100*(.2*this.revenues+this.primaryExpenses+this.secondaryExpenses))/100}},{key:"calculateGoodPractices",value:function(){var e=this;if(this.template.pagos.length>0){this.goodPracticesUsed=[];var t=!0,n=!1,r=void 0;try{for(var o,i=function(){var t=o.value,n=e.template.pagos.find((function(e){return t.palabra_clave===e.gasto_id.nombre})),r=.01*t.porcentaje*e.revenues;n&&e.goodPracticesUsed.push(n.cantidad>r?{message:"Es recomendable no sobrepasar el "+t.porcentaje+"% de los ingresos en el gasto del "+t.palabra_clave,status:!1}:{message:"No sobrepasas el "+t.porcentaje+"% de los ingresos en el gasto del "+t.palabra_clave,status:!0})},a=this.goodPractices[Symbol.iterator]();!(t=(o=a.next()).done);t=!0)i()}catch(c){n=!0,r=c}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}}},{key:"calculateTips",value:function(){0!==this.promiseSavings&&(this.tips=[],this.tips.push(this.promiseSavings<this.realSavings?{message:"Perfecto! Ahorras este mes m\xe1s de lo esperado",status:!0}:{message:"No es aconsejable ahorrar menos de lo esperado",status:!1}))}}]),e}(),ve.\u0275fac=function(e){return new(e||ve)(s.Nb(i.a),s.Nb(m.g),s.Nb(l.a),s.Nb(b.a),s.Nb(U.a),s.Nb(X.a),s.Nb(d.d),s.Nb(H.a))},ve.\u0275cmp=s.Hb({type:ve,selectors:[["app-create-template"]],decls:16,vars:6,consts:[[1,"wrapper"],[1,"row"],[1,"col-12"],[4,"ngIf"],["class","row",4,"ngIf"],["class","card",4,"ngIf"],["class","card mt-3",4,"ngIf"],["class","row mt-3",4,"ngIf"],[1,"row","mt-3","text-right"],["type","button",1,"btn","btn-primary",3,"click"],["aria-hidden","true",1,"fas","fa-arrow-left"],["src","assets/notfound.png","alt","No existen resultados",1,"d-block","mx-auto","img-not-found"],[1,"card"],[1,"card-header","bg-primary","text-white"],[1,"card-body"],[1,"row","mt-3"],[1,"form-group","col-12","col-md-6"],["for","exampleInputPassword1"],["optionLabel","name",3,"options","onChange"],["optionLabel","nombre","placeholder","Elige el recurso...",3,"options","ngModel","ngModelChange"],["class","form-group offset-md-6 col-12 col-md-3",4,"ngIf"],[1,"form-group","col-12","text-right"],["type","button",1,"btn","btn-primary",3,"disabled","click"],["aria-hidden","true",1,"fas","fa-plus"],[1,"form-group","offset-md-6","col-12","col-md-3"],[3,"routerLink"],[1,"card","mt-3"],[1,"row","mx-1","mt-5","d-none","d-md-flex"],[1,"col-4","col-md-3","offset-md-2","p-2","text-center","border","border-dark"],[1,"col-4","col-md-2","p-2","text-center","border","border-dark"],[1,"row","mx-1","text-white"],[1,"fixed-row","col-12","col-md-3","offset-md-2","p-2","text-center","border","border-dark"],[1,"fixed-row","col-12","col-md-2","p-2","text-center","border","border-dark"],[1,"fixed-row","col-12","col-md-2","p-2","text-center","border","border-dark","d-none","d-md-block"],["class","row mx-1",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["aria-hidden","true",1,"fas","fa-save"],[1,"row","mx-1"],[1,"resource-row","col-12","col-md-3","offset-md-2","text-center","border","border-dark","d-flex","justify-content-center","align-items-center","py-2","py-md-0"],[1,"resource-row","col-12","col-md-2","text-center","border","border-dark","py-2","py-md-0"],["type","textbox","placeholder","XX.XX","appTwoDigitDecimaNumber","",1,"form-control","form-control-user",3,"ngModel","input","ngModelChange"],[1,"resource-row","col-12","col-md-2","text-center","border","border-dark","border-left-0","py-2","py-md-0"],["type","button",1,"btn","btn-primary","btn-sm","mt-1",3,"click"],["aria-hidden","true",1,"fas","fa-trash-alt"],["class","row mx-1",4,"ngIf"],[1,"resource-row","col-6","col-md-1","text-center","border","border-dark","border-right-0","d-flex","justify-content-center","align-items-center","py-2","py-md-0"],["pTooltip","\xbfHa sido pagado el gasto?","tooltipPosition","top","name","groupname","binary","true",3,"ngModel","ngModelChange"],[1,"resource-row","col-6","col-md-1","primary-expense-item","text-center","border","border-dark","border-left-0","py-2","py-md-0"],[1,"resource-row","col-6","col-md-1","text-center","border","border-dark","border-left-0"],[1,"col-12","col-md-6","mt-3","mt-md-0"],[4,"ngIf","ngIfElse"],["noTips",""],["noGoodPractice",""],["class","alert text-dark","role","alert",3,"ngClass",4,"ngFor","ngForOf"],["role","alert",1,"alert","text-dark",3,"ngClass"],["role","alert",1,"alert","alert-secondary"]],template:function(e,t){1&e&&(s.Tb(0,"div",0),s.Tb(1,"div",1),s.Tb(2,"div",2),s.Ec(3,z,2,2,"h1",3),s.Ec(4,J,2,0,"h1",3),s.Sb(),s.Sb(),s.Ob(5,"hr"),s.Ec(6,V,2,0,"div",4),s.Ec(7,te,21,6,"div",5),s.Ec(8,ce,50,8,"div",6),s.Ec(9,fe,17,4,"div",7),s.Tb(10,"div",8),s.Tb(11,"div",2),s.Tb(12,"button",9),s.bc("click",(function(){return t.back()})),s.Ob(13,"i",10),s.Tb(14,"span"),s.Gc(15," Volver"),s.Sb(),s.Sb(),s.Sb(),s.Sb(),s.Sb()),2&e&&(s.Bb(3),s.jc("ngIf",t.template),s.Bb(1),s.jc("ngIf",!t.template),s.Bb(2),s.jc("ngIf",!t.template&&!t.loading),s.Bb(1),s.jc("ngIf",t.template),s.Bb(1),s.jc("ngIf",t.template),s.Bb(1),s.jc("ngIf",t.template))},directives:[m.k,p.a,a.h,a.j,i.d,m.j,a.a,Y.a,D.a,W.a,m.i],styles:[".fixed-row[_ngcontent-%COMP%]{background-color:#46545c}.resource-row[_ngcontent-%COMP%]{background-color:#f0b153}input[_ngcontent-%COMP%], input[_ngcontent-%COMP%]:focus{background:#f0b153;text-align:center;border:none!important;box-shadow:none}"]}),ve)}],Se=((ge=function e(){_classCallCheck(this,e)}).\u0275mod=s.Lb({type:ge}),ge.\u0275inj=s.Kb({factory:function(e){return new(e||ge)},imports:[[i.e.forChild(he)],i.e]}),ge);n.d(t,"TemplatesModule",(function(){return ye}));var Te,ye=((Te=function e(){_classCallCheck(this,e)}).\u0275mod=s.Lb({type:Te}),Te.\u0275inj=s.Kb({factory:function(e){return new(e||Te)},imports:[[r.a,o.a,Se]]}),Te)}}]);